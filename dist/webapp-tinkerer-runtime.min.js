!function(){"use strict";var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function n(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))}function r(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}function o(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function a(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var l={exports:{}};l.exports=function e(t,n,r){function o(l,s){if(!n[l]){if(!t[l]){if(!s&&a)return a(l);if(i)return i(l,!0);var u=new Error("Cannot find module '"+l+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[l]={exports:{}};t[l][0].call(c.exports,(function(e){var n=t[l][1][e];return o(n||e)}),c,c.exports,e,t,n,r)}return n[l].exports}for(var i=a,l=0;l<r.length;l++)o(r[l]);return o}({1:[function(e,t,n){(function(e){var n,r,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var i=0,a=new o(c),l=e.document.createTextNode("");a.observe(l,{characterData:!0}),n=function(){l.data=i=++i%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){c(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(c,0)};else{var s=new e.MessageChannel;s.port1.onmessage=c,n=function(){s.port2.postMessage(0)}}var u=[];function c(){var e,t;r=!0;for(var n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}r=!1}function f(e){1!==u.push(e)||r||n()}t.exports=f}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){var r=e(1);function o(){}var i={},a=["REJECTED"],l=["FULFILLED"],s=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=s,this.queue=[],this.outcome=void 0,e!==o&&p(this,e)}function c(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function f(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return i.reject(e,t)}r===e?i.reject(e,new TypeError("Cannot resolve promise with itself")):i.resolve(e,r)}))}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var n=!1;function r(t){n||(n=!0,i.reject(e,t))}function o(t){n||(n=!0,i.resolve(e,t))}function a(){t(o,r)}var l=h(a);"error"===l.status&&r(l.value)}function h(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function v(e){return e instanceof this?e:i.resolve(new this(o),e)}function m(e){var t=new this(o);return i.reject(t,e)}function g(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var a=new Array(n),l=0,s=-1,u=new this(o);++s<n;)c(e[s],s);return u;function c(e,o){function s(e){a[o]=e,++l!==n||r||(r=!0,i.resolve(u,a))}t.resolve(e).then(s,(function(e){r||(r=!0,i.reject(u,e))}))}}function b(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var a=-1,l=new this(o);++a<n;)s(e[a]);return l;function s(e){t.resolve(e).then((function(e){r||(r=!0,i.resolve(l,e))}),(function(e){r||(r=!0,i.reject(l,e))}))}}t.exports=u,u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===l||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(o);return this.state!==s?f(n,this.state===l?e:t,this.outcome):this.queue.push(new c(n,e,t)),n},c.prototype.callFulfilled=function(e){i.resolve(this.promise,e)},c.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},c.prototype.callRejected=function(e){i.reject(this.promise,e)},c.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},i.resolve=function(e,t){var n=h(d,t);if("error"===n.status)return i.reject(e,n.value);var r=n.value;if(r)p(e,r);else{e.state=l,e.outcome=t;for(var o=-1,a=e.queue.length;++o<a;)e.queue[o].callFulfilled(t)}return e},i.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},u.resolve=v,u.reject=m,u.all=g,u.race=b},{1:1}],3:[function(e,t,n){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var a=i();function l(){try{if(!a||!a.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function s(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var u=Promise;function c(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function f(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function d(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function p(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var h="local-forage-detect-blob-support",v=void 0,m={},g=Object.prototype.toString,b="readonly",y="readwrite";function x(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}function w(e){return new u((function(t){var n=e.transaction(h,y),r=s([""]);n.objectStore(h).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}function C(e){return"boolean"==typeof v?u.resolve(v):w(e).then((function(e){return v=e}))}function O(e){var t=m[e.name],n={};n.promise=new u((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function I(e){var t=m[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function A(e,t){var n=m[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function S(e,t){return new u((function(n,r){if(m[e.name]=m[e.name]||B(),e.db){if(!t)return n(e.db);O(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var i=a.open.apply(a,o);t&&(i.onupgradeneeded=function(t){var n=i.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(h)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),r(i.error)},i.onsuccess=function(){n(i.result),I(e)}}))}function P(e){return S(e,!1)}function T(e){return S(e,!0)}function M(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,o=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||n){if(n){var i=e.db.version+1;i>e.version&&(e.version=i)}return!0}return!1}function E(e){return new u((function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)}))}function j(e){return s([x(atob(e.data))],{type:e.type})}function N(e){return e&&e.__local_forage_encoded_blob}function k(e){var t=this,n=t._initReady().then((function(){var e=m[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return f(n,e,e),n}function W(e){O(e);for(var t=m[e.name],n=t.forages,r=0;r<n.length;r++){var o=n[r];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,P(e).then((function(t){return e.db=t,M(e)?T(e):t})).then((function(r){e.db=t.db=r;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=r})).catch((function(t){throw A(e,t),t}))}function L(e,t,n,r){void 0===r&&(r=1);try{var o=e.db.transaction(e.storeName,t);n(null,o)}catch(o){if(r>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return u.resolve().then((function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),T(e)})).then((function(){return W(e).then((function(){L(e,t,n,r-1)}))})).catch(n);n(o)}}function B(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function _(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var o=m[n.name];o||(o=B(),m[n.name]=o),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=k);var i=[];function a(){return u.resolve()}for(var l=0;l<o.forages.length;l++){var s=o.forages[l];s!==t&&i.push(s._initReady().catch(a))}var c=o.forages.slice(0);return u.all(i).then((function(){return n.db=o.db,P(n)})).then((function(e){return n.db=e,M(n,t._defaultConfig.version)?T(n):e})).then((function(e){n.db=o.db=e,t._dbInfo=n;for(var r=0;r<c.length;r++){var i=c[r];i!==t&&(i._dbInfo.db=n.db,i._dbInfo.version=n.version)}}))}function V(e,t){var n=this;e=d(e);var r=new u((function(t,r){n.ready().then((function(){L(n._dbInfo,b,(function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName).get(e);a.onsuccess=function(){var e=a.result;void 0===e&&(e=null),N(e)&&(e=j(e)),t(e)},a.onerror=function(){r(a.error)}}catch(e){r(e)}}))})).catch(r)}));return c(r,t),r}function F(e,t){var n=this,r=new u((function(t,r){n.ready().then((function(){L(n._dbInfo,b,(function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName).openCursor(),l=1;a.onsuccess=function(){var n=a.result;if(n){var r=n.value;N(r)&&(r=j(r));var o=e(r,n.key,l++);void 0!==o?t(o):n.continue()}else t()},a.onerror=function(){r(a.error)}}catch(e){r(e)}}))})).catch(r)}));return c(r,t),r}function D(e,t,n){var r=this;e=d(e);var o=new u((function(n,o){var i;r.ready().then((function(){return i=r._dbInfo,"[object Blob]"===g.call(t)?C(i.db).then((function(e){return e?t:E(t)})):t})).then((function(t){L(r._dbInfo,y,(function(i,a){if(i)return o(i);try{var l=a.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var s=l.put(t,e);a.oncomplete=function(){void 0===t&&(t=null),n(t)},a.onabort=a.onerror=function(){var e=s.error?s.error:s.transaction.error;o(e)}}catch(e){o(e)}}))})).catch(o)}));return c(o,n),o}function R(e,t){var n=this;e=d(e);var r=new u((function(t,r){n.ready().then((function(){L(n._dbInfo,y,(function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName).delete(e);i.oncomplete=function(){t()},i.onerror=function(){r(a.error)},i.onabort=function(){var e=a.error?a.error:a.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return c(r,t),r}function z(e){var t=this,n=new u((function(e,n){t.ready().then((function(){L(t._dbInfo,y,(function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return c(n,e),n}function U(e){var t=this,n=new u((function(e,n){t.ready().then((function(){L(t._dbInfo,b,(function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName).count();i.onsuccess=function(){e(i.result)},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return c(n,e),n}function H(e,t){var n=this,r=new u((function(t,r){e<0?t(null):n.ready().then((function(){L(n._dbInfo,b,(function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName),l=!1,s=a.openKeyCursor();s.onsuccess=function(){var n=s.result;n?0===e||l?t(n.key):(l=!0,n.advance(e)):t(null)},s.onerror=function(){r(s.error)}}catch(e){r(e)}}))})).catch(r)}));return c(r,t),r}function q(e){var t=this,n=new u((function(e,n){t.ready().then((function(){L(t._dbInfo,b,(function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName).openKeyCursor(),a=[];i.onsuccess=function(){var t=i.result;t?(a.push(t.key),t.continue()):e(a)},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return c(n,e),n}function $(e,t){t=p.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;if(e.name){var i=e.name===n.name&&o._dbInfo.db?u.resolve(o._dbInfo.db):P(e).then((function(t){var n=m[e.name],r=n.forages;n.db=t;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=t;return t}));r=e.storeName?i.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;O(e);var r=m[e.name],o=r.forages;t.close();for(var i=0;i<o.length;i++){var l=o[i];l._dbInfo.db=null,l._dbInfo.version=n}return new u((function(t,r){var o=a.open(e.name,n);o.onerror=function(e){o.result.close(),r(e)},o.onupgradeneeded=function(){o.result.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<o.length;t++){var n=o[t];n._dbInfo.db=e,I(n._dbInfo)}})).catch((function(t){throw(A(e,t)||u.resolve()).catch((function(){})),t}))}})):i.then((function(t){O(e);var n=m[e.name],r=n.forages;t.close();for(var o=0;o<r.length;o++)r[o]._dbInfo.db=null;return new u((function(t,n){var r=a.deleteDatabase(e.name);r.onerror=r.onblocked=function(e){var t=r.result;t&&t.close(),n(e)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<r.length;t++)I(r[t]._dbInfo)})).catch((function(t){throw(A(e,t)||u.resolve()).catch((function(){})),t}))}))}else r=u.reject("Invalid arguments");return c(r,t),r}var J={_driver:"asyncStorage",_initStorage:_,_support:l(),iterate:F,getItem:V,setItem:D,removeItem:R,clear:z,length:U,key:H,keys:q,dropInstance:$};function G(){return"function"==typeof openDatabase}var Z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",K="~~local_forage_type~",Q=/^~~local_forage_type~([^~]+)~/,X="__lfsc__:",Y=X.length,ee="arbf",te="blob",ne="si08",re="ui08",oe="uic8",ie="si16",ae="si32",le="ur16",se="ui32",ue="fl32",ce="fl64",fe=Y+ee.length,de=Object.prototype.toString;function pe(e){var t,n,r,o,i,a=.75*e.length,l=e.length,s=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var u=new ArrayBuffer(a),c=new Uint8Array(u);for(t=0;t<l;t+=4)n=Z.indexOf(e[t]),r=Z.indexOf(e[t+1]),o=Z.indexOf(e[t+2]),i=Z.indexOf(e[t+3]),c[s++]=n<<2|r>>4,c[s++]=(15&r)<<4|o>>2,c[s++]=(3&o)<<6|63&i;return u}function he(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=Z[n[t]>>2],r+=Z[(3&n[t])<<4|n[t+1]>>4],r+=Z[(15&n[t+1])<<2|n[t+2]>>6],r+=Z[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function ve(e,t){var n="";if(e&&(n=de.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===de.call(e.buffer))){var r,o=X;e instanceof ArrayBuffer?(r=e,o+=ee):(r=e.buffer,"[object Int8Array]"===n?o+=ne:"[object Uint8Array]"===n?o+=re:"[object Uint8ClampedArray]"===n?o+=oe:"[object Int16Array]"===n?o+=ie:"[object Uint16Array]"===n?o+=le:"[object Int32Array]"===n?o+=ae:"[object Uint32Array]"===n?o+=se:"[object Float32Array]"===n?o+=ue:"[object Float64Array]"===n?o+=ce:t(new Error("Failed to get type for BinaryArray"))),t(o+he(r))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var n=K+e.type+"~"+he(this.result);t(X+te+n)},i.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}}function me(e){if(e.substring(0,Y)!==X)return JSON.parse(e);var t,n=e.substring(fe),r=e.substring(Y,fe);if(r===te&&Q.test(n)){var o=n.match(Q);t=o[1],n=n.substring(o[0].length)}var i=pe(n);switch(r){case ee:return i;case te:return s([i],{type:t});case ne:return new Int8Array(i);case re:return new Uint8Array(i);case oe:return new Uint8ClampedArray(i);case ie:return new Int16Array(i);case le:return new Uint16Array(i);case ae:return new Int32Array(i);case se:return new Uint32Array(i);case ue:return new Float32Array(i);case ce:return new Float64Array(i);default:throw new Error("Unkown type: "+r)}}var ge={serialize:ve,deserialize:me,stringToBuffer:pe,bufferToString:he};function be(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function ye(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var o=new u((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(o){be(o,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=ge,o}function xe(e,t,n,r,o,i){e.executeSql(n,r,o,(function(e,a){a.code===a.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,l){l.rows.length?i(e,a):be(e,t,(function(){e.executeSql(n,r,o,i)}),i)}),i):i(e,a)}),i)}function we(e,t){var n=this;e=d(e);var r=new u((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){xe(n,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return c(r,t),r}function Ce(e,t){var n=this,r=new u((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){xe(n,o,"SELECT * FROM "+o.storeName,[],(function(n,r){for(var i=r.rows,a=i.length,l=0;l<a;l++){var s=i.item(l),u=s.value;if(u&&(u=o.serializer.deserialize(u)),void 0!==(u=e(u,s.key,l+1)))return void t(u)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return c(r,t),r}function Oe(e,t,n,r){var o=this;e=d(e);var i=new u((function(i,a){o.ready().then((function(){void 0===t&&(t=null);var l=t,s=o._dbInfo;s.serializer.serialize(t,(function(t,u){u?a(u):s.db.transaction((function(n){xe(n,s,"INSERT OR REPLACE INTO "+s.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){i(l)}),(function(e,t){a(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void i(Oe.apply(o,[e,l,n,r-1]));a(t)}}))}))})).catch(a)}));return c(i,n),i}function Ie(e,t,n){return Oe.apply(this,[e,t,n,1])}function Ae(e,t){var n=this;e=d(e);var r=new u((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){xe(n,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return c(r,t),r}function Se(e){var t=this,n=new u((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){xe(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return c(n,e),n}function Pe(e){var t=this,n=new u((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){xe(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return c(n,e),n}function Te(e,t){var n=this,r=new u((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){xe(n,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return c(r,t),r}function Me(e){var t=this,n=new u((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){xe(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return c(n,e),n}function Ee(e){return new u((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var o=[],i=0;i<r.rows.length;i++)o.push(r.rows.item(i).name);t({db:e,storeNames:o})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}function je(e,t){t=p.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;return c(r=e.name?new u((function(t){var r;r=e.name===n.name?o._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(Ee(r))})).then((function(e){return new u((function(t,n){e.db.transaction((function(r){function o(e){return new u((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var i=[],a=0,l=e.storeNames.length;a<l;a++)i.push(o(e.storeNames[a]));u.all(i).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):u.reject("Invalid arguments"),t),r}var Ne={_driver:"webSQLStorage",_initStorage:ye,_support:G(),iterate:Ce,getItem:we,setItem:Ie,removeItem:Ae,clear:Se,length:Pe,key:Te,keys:Me,dropInstance:je};function ke(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function We(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function Le(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}function Be(){return!Le()||localStorage.length>0}function _e(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=We(e,t._defaultConfig),Be()?(t._dbInfo=n,n.serializer=ge,u.resolve()):u.reject()}function Ve(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return c(n,e),n}function Fe(e,t){var n=this;e=d(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return c(r,t),r}function De(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,o=r.length,i=localStorage.length,a=1,l=0;l<i;l++){var s=localStorage.key(l);if(0===s.indexOf(r)){var u=localStorage.getItem(s);if(u&&(u=t.serializer.deserialize(u)),void 0!==(u=e(u,s.substring(o),a++)))return u}}}));return c(r,t),r}function Re(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return c(r,t),r}function ze(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++){var i=localStorage.key(o);0===i.indexOf(e.keyPrefix)&&r.push(i.substring(e.keyPrefix.length))}return r}));return c(n,e),n}function Ue(e){var t=this.keys().then((function(e){return e.length}));return c(t,e),t}function He(e,t){var n=this;e=d(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return c(r,t),r}function qe(e,t,n){var r=this;e=d(e);var o=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new u((function(o,i){var a=r._dbInfo;a.serializer.serialize(t,(function(t,r){if(r)i(r);else try{localStorage.setItem(a.keyPrefix+e,t),o(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||i(e),i(e)}}))}))}));return c(o,n),o}function $e(e,t){if(t=p.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,o=this;return c(r=e.name?new u((function(t){e.storeName?t(We(e,o._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):u.reject("Invalid arguments"),t),r}var Je={_driver:"localStorageWrapper",_initStorage:_e,_support:ke(),iterate:De,getItem:Fe,setItem:qe,removeItem:He,clear:Ve,length:Ue,key:Re,keys:ze,dropInstance:$e},Ge=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},Ze=function(e,t){for(var n=e.length,r=0;r<n;){if(Ge(e[r],t))return!0;r++}return!1},Ke=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Qe={},Xe={},Ye={INDEXEDDB:J,WEBSQL:Ne,LOCALSTORAGE:Je},et=[Ye.INDEXEDDB._driver,Ye.WEBSQL._driver,Ye.LOCALSTORAGE._driver],tt=["dropInstance"],nt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),rt={description:"",driver:et.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ot(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function it(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(Ke(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var at=new(function(){function e(t){for(var n in o(this,e),Ye)if(Ye.hasOwnProperty(n)){var r=Ye[n],i=r._driver;this[n]=i,Qe[i]||this.defineDriver(r)}this._defaultConfig=it({},rt),this._config=it({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new u((function(t,n){try{var r=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(o);for(var i=nt.concat("_initStorage"),a=0,l=i.length;a<l;a++){var s=i[a];if((!Ze(tt,s)||e[s])&&"function"!=typeof e[s])return void n(o)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=u.reject(t);return c(n,arguments[arguments.length-1]),n}},n=0,r=tt.length;n<r;n++){var o=tt[n];e[o]||(e[o]=t(o))}}();var f=function(n){Qe[r]&&console.info("Redefining LocalForage driver: "+r),Qe[r]=e,Xe[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(f,n):f(!!e._support):f(!0)}catch(e){n(e)}}));return f(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=Qe[e]?u.resolve(Qe[e]):u.reject(new Error("Driver not found."));return f(r,t,n),r},e.prototype.getSerializer=function(e){var t=u.resolve(ge);return f(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return f(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;Ke(e)||(e=[e]);var o=this._getSupportedDrivers(e);function i(){r._config.driver=r.driver()}function a(e){return r._extend(e),i(),r._ready=r._initStorage(r._config),r._ready}function l(e){return function(){var t=0;function n(){for(;t<e.length;){var o=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(o).then(a).catch(n)}i();var l=new Error("No available storage method found.");return r._driverSet=u.reject(l),r._driverSet}return n()}}var s=null!==this._driverSet?this._driverSet.catch((function(){return u.resolve()})):u.resolve();return this._driverSet=s.then((function(){var e=o[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,i(),r._wrapLibraryMethodsWithReady(),r._initDriver=l(o)}))})).catch((function(){i();var e=new Error("No available storage method found.");return r._driverSet=u.reject(e),r._driverSet})),f(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!Xe[e]},e.prototype._extend=function(e){it(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=nt.length;e<t;e++)ot(this,nt[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=at},{3:3}]},{},[4])(4);var s=l.exports,u=Function("return this")();function c(e,t){return null==e||"hasOwnProperty"in e&&"function"==typeof e.hasOwnProperty?e.hasOwnProperty(t):Object.prototype.hasOwnProperty.call(e,t)}function f(e,t){return null==e||"isPrototypeOf"in e&&"function"==typeof e.isPrototypeOf?e.isPrototypeOf(t):Object.prototype.isPrototypeOf.call(e,t)}function d(e){var t=/^([$a-zA-Z][$a-zA-Z0-9]*):\s*(\S.+)\s*$/.exec(e);if(null==t)throw new Error(e);var n=new Error(t[2]);throw n.name=t[1],n}function p(e){return"boolean"==typeof e||e instanceof Boolean}function h(e){return"number"==typeof e||e instanceof Number}function v(e){return("number"==typeof e||e instanceof Number)&&isFinite(e.valueOf())}function m(e){return("number"==typeof e||e instanceof Number)&&isNaN(e.valueOf())}function g(e,t,n,r,o){if(void 0===r&&(r=!0),void 0===o&&(o=!0),!h(e)||isNaN(e))return!1;if(v(t)){if(v(n)){if(e<t||!r&&e===t||e>n||!o&&e===n)return!1}else if(e<t||!r&&e===t)return!1}else if(v(n)&&(e>n||!o&&e===n))return!1;return!0}function b(e){return("number"==typeof e||e instanceof Number)&&(e=e.valueOf(),isFinite(e)&&Math.round(e)===e)}function y(e){return("number"==typeof e||e instanceof Number)&&(e=e.valueOf(),isFinite(e)&&Math.round(e)===e&&e>=0)}function x(e){return("number"==typeof e||e instanceof Number)&&(e=e.valueOf(),isFinite(e)&&Math.round(e)===e&&e>=1)}function w(e){return"string"==typeof e||e instanceof String}var C=/^\s*$/;function O(e){return("string"==typeof e||e instanceof String)&&!C.test(e.valueOf())}function I(e,t){return("string"==typeof e||e instanceof String)&&t.test(e.valueOf())}var A=/^[^\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F\u2028\u2029\uFFF9-\uFFFB]*$/;function S(e){return I(e,A)}var P=/^[^\x00-\x1F\x7F-\x9F\u2028\u2029\uFFF9-\uFFFB]*$/;function T(e){return I(e,P)}function M(e){return"function"==typeof e}function E(e){return"function"==typeof e&&(null==e.name||""===e.name)}function j(e){return"function"==typeof e&&null!=e.name&&""!==e.name}function N(e){return"function"==typeof e&&/^function\s*[^(]*\(\)\s*\{\s*\[native code\]\s*\}\s*$/.test(e.toString())}function k(e){return"function"==typeof e&&!/^function\s*[^(]*\(\)\s*\{\s*\[native code\]\s*\}\s*$/.test(e.toString())}function W(e){return null!=e&&"object"==typeof e}function L(e){return null!=e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype}function B(e){return null!=e&&"object"==typeof e&&!(e instanceof Object)}var _=Array.isArray;function V(e,t,n){if(_(e)){for(var r=0,o=e.length;r<o;r++)if(void 0===e[r])return!1;return!(null!=t&&e.length<t)&&!(null!=n&&e.length>n)}return!1}function F(e,t,n,r){if(_(e))try{for(var o=0,i=e.length;o<i;o++)if(0==t(e[o]))return!1;return!(null!=n&&e.length<n)&&!(null!=r&&e.length>r)}catch(e){}return!1}function D(e){return e instanceof Date}function R(e){return e instanceof Error}function z(e){return null!=e&&"function"==typeof e.then}function U(e){return e instanceof RegExp}function H(e,t){return t.indexOf(e)>=0}function q(e){return w(e)&&(Hn.hasOwnProperty(e)||/^#[a-fA-F0-9]{6}$/.test(e)||/^#[a-fA-F0-9]{8}$/.test(e)||/^rgb\([0-9]+,\s*[0-9]+,\s*[0-9]+\)$/.test(e)||/^rgba\([0-9]+,\s*[0-9]+,\s*[0-9]+,([01]|[0]?[.][0-9]+)\)$/.test(e))}var $=/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/;function J(e){return I(e,$)}var G=/^[^\s\x00-\x1F\x7F-\x9F\u2028\u2029\uFFF9-\uFFFB]*$/;function Z(e){if(!I(e,G)||""===e)return!1;try{return new URL(e,"file://"),!0}catch(e){return!1}}var K=!1,Q=!0;function X(e,t,n,r,o){if(null==t){if(r)return t;d("MissingArgument: no "+Bn(e)+" given")}else if(n(t))switch(!0){case t instanceof Boolean:case t instanceof Number:case t instanceof String:return t.valueOf();default:return t}else d("InvalidArgument: the given "+Bn(e)+" is no valid "+Bn(o))}function Y(e,t,n){var r=function(r,o){return X(r,o,e,t,n)},o=e.name;return null!=o&&/^ValueIs/.test(o)?ee(r,o.replace(/^ValueIs/,t?"allow":"expect")):r}function ee(e,t){if(null==e&&d("MissingArgument: no function given"),"function"!=typeof e&&d("InvalidArgument: the given 1st Argument is not a JavaScript function"),null==t&&d("MissingArgument: no desired name given"),"string"==typeof t||t instanceof String||d("InvalidArgument: the given desired name is not a string"),e.name===t)return e;try{if(Object.defineProperty(e,"name",{value:t}),e.name===t)return e}catch(e){}return new Function("originalFunction","return function "+t+" () {return originalFunction.apply(this,Array.prototype.slice.apply(arguments))}")(e)}function te(e,t){if(null!=t)return t.valueOf();d("MissingArgument: no "+Bn(e)+" given")}var ne=te,re=Y(p,Q,"boolean value"),oe=re,ie=Y(p,K,"boolean value"),ae=ie,le=Y(h,Q,"numeric value"),se=le,ue=Y(h,K,"numeric value"),ce=ue,fe=Y(v,Q,"finite numeric value"),de=fe,pe=Y(v,K,"finite numeric value"),he=pe,ve=Y(m,Q,"NaN value"),me=ve,ge=Y(m,K,"NaN value"),be=ge;function ye(e,t,n,r,o,i){return null==t?t:Ce(e,t,n,r,o,i)}var xe=ye;function we(e,t,n,r,o,i){if(ue(e,t),isNaN(t)&&d("InvalidArgument: the given "+Bn(e)+" is not-a-number"),null==o&&(o=!0),null==i&&(i=!0),null!=n&&isFinite(n)){if(null!=r&&isFinite(r)){if(t<n||!o&&t===n||t>r||!i&&t===r)throw new RangeError("the given "+Bn(e)+" ("+t+") is outside the allowed range ("+n+"..."+r+")")}else if(t<n||!o&&t===n)throw new RangeError("the given "+Bn(e)+" is below the allowed minimum ("+t+" "+(o?"<":"<=")+" "+n+")")}else if(null!=r&&isFinite(r)&&(t>r||!i&&t===r))throw new RangeError("the given "+Bn(e)+" exceeds the allowed maximum ("+t+" "+(i?">":">=")+" "+r+")");return t.valueOf()}var Ce=we,Oe=Y(b,Q,"integral numeric value"),Ie=Oe,Ae=Y(b,K,"integral numeric value"),Se=Ae;function Pe(e,t,n,r){return null==t?t:Ee(e,t,n,r)}var Te=Pe;function Me(e,t,n,r){if(Ae(e,t),isNaN(t)&&d("InvalidArgument: the given "+Bn(e)+" is not-a-number"),null!=n&&isFinite(n)){if(null!=r&&isFinite(r)){if(t<n||t>r)throw new RangeError("the given "+Bn(e)+" ("+t+") is outside the allowed range ("+n+"..."+r+")")}else if(t<n)throw new RangeError("the given "+Bn(e)+" is below the allowed minimum ("+t+" < "+n+")")}else if(null!=r&&isFinite(r)&&t>r)throw new RangeError("the given "+Bn(e)+" exceeds the allowed maximum ("+t+" > "+r+")");return t.valueOf()}var Ee=Me,je=Y(y,Q,"ordinal number"),Ne=je,ke=Y(y,K,"ordinal number"),We=ke,Le=Y(x,Q,"cardinal number"),Be=Le,_e=Y(x,K,"cardinal number"),Ve=_e,Fe=Y(w,Q,"literal string"),De=Fe,Re=Y(w,K,"literal string"),ze=Re,Ue=Y(O,Q,"non-empty literal string"),He=Ue,qe=Y(O,K,"non-empty literal string"),$e=qe;function Je(e,t,n){return null==t?t:Ke(e,t,n)}var Ge=Je;function Ze(e,t,n){if(Re(e,t),n.test(t))return t.valueOf();d("InvalidArgument: the given "+Bn(e)+" does not match the specified pattern")}var Ke=Ze,Qe=Y(S,Q,"literal text"),Xe=Qe,Ye=Y(S,K,"literal text"),et=Ye,tt=Y(T,Q,"single line of text"),nt=tt,rt=Y(T,K,"single line of text"),ot=rt,it=Y(M,Q,"JavaScript function"),at=it,lt=Y(M,K,"JavaScript function"),st=lt,ut=Y(E,Q,"anonymous JavaScript function"),ct=ut,ft=Y(E,K,"anonymous JavaScript function"),dt=ft,pt=Y(j,Q,"named JavaScript function"),ht=pt,vt=Y(j,K,"named JavaScript function"),mt=vt,gt=Y(N,Q,"native JavaScript function"),bt=gt,yt=Y(N,K,"native JavaScript function"),xt=yt,wt=Y(k,Q,"scripted JavaScript function"),Ct=wt,Ot=Y(k,K,"scripted JavaScript function"),It=Ot,At=Y(W,Q,"JavaScript object"),St=At,Pt=Y(W,K,"JavaScript object"),Tt=Pt,Mt=Y(L,Q,'"plain" JavaScript object'),Et=Mt,jt=Y(L,K,'"plain" JavaScript object'),Nt=jt,kt=Y(B,Q,'"vanilla" JavaScript object'),Wt=kt,Lt=Y(B,K,'"vanilla" JavaScript object'),Bt=Lt;function _t(e,t){return null==t?t:Dt(e,t)}var Vt=_t;function Ft(e,t){if(null==t&&d("MissingArgument: no "+Bn(e)+" given"),_(t))return t;d("InvalidArgument: the given "+Bn(e)+" is no JavaScript array")}var Dt=Ft;function Rt(e,t,n,r,o){return null==t?t:Ht(e,t,n,r,o)}var zt=Rt;function Ut(e,t,n,r,o){if(null==t&&d("MissingArgument: no "+Bn(e)+" given"),V(t,r,o))return t;d("InvalidArgument: the given "+Bn(e)+" is "+(null==n?"either not a list or contains an invalid number of elements":"no "+Bn(n)))}var Ht=Ut;function qt(e,t,n,r,o,i){return null==t?t:Gt(e,t,n,r,o,i)}var $t=qt;function Jt(e,t,n,r,o,i){if(null==t&&d("MissingArgument: no "+Bn(e)+" given"),F(t,n,o,i))return t;d("InvalidArgument: the given "+Bn(e)+" is "+(null==r?"either not a list or contains invalid elements":"no "+Bn(r)))}var Gt=Jt;function Zt(e,t,n,r){return null==t?t:Xt(e,t,n,r)}var Kt=Zt;function Qt(e,t,n,r){return null==t&&d("MissingArgument: no "+Bn(e)+" given"),t instanceof n||d("InvalidArgument: the given "+Bn(e)+" is no "+Bn(r)),t}var Xt=Qt;function Yt(e,t,n,r){return null==t?t:nn(e,t,n,r)}var en=Yt;function tn(e,t,n,r){if(null==t&&d("MissingArgument: no "+Bn(e)+" given"),n.isPrototypeOf(t))return t;d("InvalidArgument: the given "+Bn(e)+" is no "+Bn(r))}var nn=tn,rn=Y(D,Q,"JavaScript Date object"),on=rn,an=Y(D,K,"JavaScript Date object"),ln=an,sn=Y(R,Q,"JavaScript Error object"),un=sn,cn=Y(R,K,"JavaScript Error object"),fn=cn,dn=Y(z,Q,'JavaScript Promise (or "Thenable") object'),pn=dn,hn=Y(z,K,'JavaScript Promise (or "Thenable") object'),vn=hn,mn=Y(U,Q,"JavaScript RegExp object"),gn=mn,bn=Y(U,K,"JavaScript RegExp object"),yn=bn;function xn(e,t,n){return null==t?t:On(e,t,n)}var wn=xn;function Cn(e,t,n){if(null==t&&d("MissingArgument: no "+Bn(e)+" given"),H(t,n))return null==t||"function"!=typeof t.valueOf?t:t.valueOf();d("InvalidArgument: the given "+Bn(e)+" is not among the supported values")}var On=Cn,In=Y(q,Q,"valid CSS color specification"),An=In,Sn=Y(q,K,"valid CSS color specification"),Pn=Sn,Tn=Y(J,Q,"valid EMail address"),Mn=Tn,En=Y(J,K,"valid EMail address"),jn=En,Nn=Y(Z,Q,"valid URL"),kn=Nn,Wn=Y(Z,K,"valid URL"),Ln=Wn;function Bn(e){return e.replace(/\\x[0-9a-zA-Z]{2}|\\u[0-9a-zA-Z]{4}|\\[0bfnrtv'"\\\/]?/g,(function(e){return"\\"===e?"\\\\":e})).replace(/[\x00-\x1f\x7f-\x9f]/g,(function(e){switch(e){case"\0":return"\\0";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\v":return"\\v";default:var t=e.charCodeAt(0).toString(16);return"\\x"+"00".slice(t.length)+t}}))}function _n(e,t){void 0===t&&(t='"');return e.replace("'"===t?/\\x[0-9a-zA-Z]{2}|\\u[0-9a-zA-Z]{4}|\\[0bfnrtv'"\\\/]?|'/g:/\\x[0-9a-zA-Z]{2}|\\u[0-9a-zA-Z]{4}|\\[0bfnrtv'"\\\/]?|"/g,(function(e){switch(e){case"'":return"\\'";case'"':return'\\"';case"\\":return"\\\\";default:return e}})).replace(/[\x00-\x1f\x7f-\x9f]/g,(function(e){switch(e){case"\0":return"\\0";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\v":return"\\v";default:var t=e.charCodeAt(0).toString(16);return"\\x"+"00".slice(t.length)+t}}))}function Vn(e,t){return void 0===t&&(t='"'),t+_n(e,t)+t}function Fn(e,t){return t=(t||"").trim()||"<br/>",e.replace(/[&<>"'\u0000-\u001F\u007F-\u009F\\]/g,(function(e){switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"\b":return"&#92;b";case"\f":return"&#92;f";case"\n":return t;case"\r":return"&#92;r";case"\t":return"&#92;t";case"\v":return"&#92;v";case"\\":return"&#92;";default:var n=e.charCodeAt(0).toString(16);return"&#x0000".substring(3,7-n.length)+n+";"}}))}function Dn(e,t){if(e===t)return!1;var n=typeof e;if(n!==typeof t)return!0;switch(n){case"undefined":case"boolean":case"string":case"function":return!0;case"number":return isNaN(e)!==isNaN(t)||Math.abs(e-t)>Number.EPSILON;case"object":return null==e||(null==t||(Array.isArray(e)?function(e,t){if(!Array.isArray(t))return!0;if(e.length!==t.length)return!0;for(var n=0,r=e.length;n<r;n++)if(Dn(e[n],t[n]))return!0;return!1}(e,t):function(e,t){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!0;for(var n in e)if(!(n in t))return!0;for(var n in t){if(!(n in e))return!0;if(Dn(e[n],t[n]))return!0}return!1}(e,t)));default:return!0}return!0}function Rn(e,t){return!Dn(e,t)}function zn(e){for(var t in Pt("candidate",e),e)if(c(e,t))return!1;return!0}function Un(e){return/^\s*$/.test(e)}var Hn={transparent:"rgba(0,0,0,0,0.0)",aliceblue:"rgba(240,248,255,1.0)",lightpink:"rgba(255,182,193,1.0)",antiquewhite:"rgba(250,235,215,1.0)",lightsalmon:"rgba(255,160,122,1.0)",aqua:"rgba(0,255,255,1.0)",lightseagreen:"rgba(32,178,170,1.0)",aquamarine:"rgba(127,255,212,1.0)",lightskyblue:"rgba(135,206,250,1.0)",azure:"rgba(240,255,255,1.0)",lightslategray:"rgba(119,136,153,1.0)",beige:"rgba(245,245,220,1.0)",lightslategrey:"rgba(119,136,153,1.0)",bisque:"rgba(255,228,196,1.0)",lightsteelblue:"rgba(176,196,222,1.0)",black:"rgba(0,0,0,1.0)",lightyellow:"rgba(255,255,224,1.0)",blanchedalmond:"rgba(255,235,205,1.0)",lime:"rgba(0,255,0,1.0)",blue:"rgba(0,0,255,1.0)",limegreen:"rgba(50,205,50,1.0)",blueviolet:"rgba(138,43,226,1.0)",linen:"rgba(250,240,230,1.0)",brown:"rgba(165,42,42,1.0)",magenta:"rgba(255,0,255,1.0)",burlywood:"rgba(222,184,135,1.0)",maroon:"rgba(128,0,0,1.0)",cadetblue:"rgba(95,158,160,1.0)",mediumaquamarine:"rgba(102,205,170,1.0)",chartreuse:"rgba(127,255,0,1.0)",mediumblue:"rgba(0,0,205,1.0)",chocolate:"rgba(210,105,30,1.0)",mediumorchid:"rgba(186,85,211,1.0)",coral:"rgba(255,127,80,1.0)",mediumpurple:"rgba(147,112,219,1.0)",cornflowerblue:"rgba(100,149,237,1.0)",mediumseagreen:"rgba(60,179,113,1.0)",cornsilk:"rgba(255,248,220,1.0)",mediumslateblue:"rgba(123,104,238,1.0)",crimson:"rgba(220,20,60,1.0)",mediumspringgreen:"rgba(0,250,154,1.0)",cyan:"rgba(0,255,255,1.0)",mediumturquoise:"rgba(72,209,204,1.0)",darkblue:"rgba(0,0,139,1.0)",mediumvioletred:"rgba(199,21,133,1.0)",darkcyan:"rgba(0,139,139,1.0)",midnightblue:"rgba(25,25,112,1.0)",darkgoldenrod:"rgba(184,134,11,1.0)",mintcream:"rgba(245,255,250,1.0)",darkgray:"rgba(169,169,169,1.0)",mistyrose:"rgba(255,228,225,1.0)",darkgreen:"rgba(0,100,0,1.0)",moccasin:"rgba(255,228,181,1.0)",darkgrey:"rgba(169,169,169,1.0)",navajowhite:"rgba(255,222,173,1.0)",darkkhaki:"rgba(189,183,107,1.0)",navy:"rgba(0,0,128,1.0)",darkmagenta:"rgba(139,0,139,1.0)",oldlace:"rgba(253,245,230,1.0)",darkolivegreen:"rgba(85,107,47,1.0)",olive:"rgba(128,128,0,1.0)",darkorange:"rgba(255,140,0,1.0)",olivedrab:"rgba(107,142,35,1.0)",darkorchid:"rgba(153,50,204,1.0)",orange:"rgba(255,165,0,1.0)",darkred:"rgba(139,0,0,1.0)",orangered:"rgba(255,69,0,1.0)",darksalmon:"rgba(233,150,122,1.0)",orchid:"rgba(218,112,214,1.0)",darkseagreen:"rgba(143,188,143,1.0)",palegoldenrod:"rgba(238,232,170,1.0)",darkslateblue:"rgba(72,61,139,1.0)",palegreen:"rgba(152,251,152,1.0)",darkslategray:"rgba(47,79,79,1.0)",paleturquoise:"rgba(175,238,238,1.0)",darkslategrey:"rgba(47,79,79,1.0)",palevioletred:"rgba(219,112,147,1.0)",darkturquoise:"rgba(0,206,209,1.0)",papayawhip:"rgba(255,239,213,1.0)",darkviolet:"rgba(148,0,211,1.0)",peachpuff:"rgba(255,218,185,1.0)",deeppink:"rgba(255,20,147,1.0)",peru:"rgba(205,133,63,1.0)",deepskyblue:"rgba(0,191,255,1.0)",pink:"rgba(255,192,203,1.0)",dimgray:"rgba(105,105,105,1.0)",plum:"rgba(221,160,221,1.0)",dimgrey:"rgba(105,105,105,1.0)",powderblue:"rgba(176,224,230,1.0)",dodgerblue:"rgba(30,144,255,1.0)",purple:"rgba(128,0,128,1.0)",firebrick:"rgba(178,34,34,1.0)",red:"rgba(255,0,0,1.0)",floralwhite:"rgba(255,250,240,1.0)",rosybrown:"rgba(188,143,143,1.0)",forestgreen:"rgba(34,139,34,1.0)",royalblue:"rgba(65,105,225,1.0)",fuchsia:"rgba(255,0,255,1.0)",saddlebrown:"rgba(139,69,19,1.0)",gainsboro:"rgba(220,220,220,1.0)",salmon:"rgba(250,128,114,1.0)",ghostwhite:"rgba(248,248,255,1.0)",sandybrown:"rgba(244,164,96,1.0)",gold:"rgba(255,215,0,1.0)",seagreen:"rgba(46,139,87,1.0)",goldenrod:"rgba(218,165,32,1.0)",seashell:"rgba(255,245,238,1.0)",gray:"rgba(128,128,128,1.0)",sienna:"rgba(160,82,45,1.0)",green:"rgba(0,128,0,1.0)",silver:"rgba(192,192,192,1.0)",greenyellow:"rgba(173,255,47,1.0)",skyblue:"rgba(135,206,235,1.0)",grey:"rgba(128,128,128,1.0)",slateblue:"rgba(106,90,205,1.0)",honeydew:"rgba(240,255,240,1.0)",slategray:"rgba(112,128,144,1.0)",hotpink:"rgba(255,105,180,1.0)",slategrey:"rgba(112,128,144,1.0)",indianred:"rgba(205,92,92,1.0)",snow:"rgba(255,250,250,1.0)",indigo:"rgba(75,0,130,1.0)",springgreen:"rgba(0,255,127,1.0)",ivory:"rgba(255,255,240,1.0)",steelblue:"rgba(70,130,180,1.0)",khaki:"rgba(240,230,140,1.0)",tan:"rgba(210,180,140,1.0)",lavender:"rgba(230,230,250,1.0)",teal:"rgba(0,128,128,1.0)",lavenderblush:"rgba(255,240,245,1.0)",thistle:"rgba(216,191,216,1.0)",lawngreen:"rgba(124,252,0,1.0)",tomato:"rgba(255,99,71,1.0)",lemonchiffon:"rgba(255,250,205,1.0)",turquoise:"rgba(64,224,208,1.0)",lightblue:"rgba(173,216,230,1.0)",violet:"rgba(238,130,238,1.0)",lightcoral:"rgba(240,128,128,1.0)",wheat:"rgba(245,222,179,1.0)",lightcyan:"rgba(224,255,255,1.0)",white:"rgba(255,255,255,1.0)",lightgoldenrodyellow:"rgba(250,250,210,1.0)",whitesmoke:"rgba(245,245,245,1.0)",lightgray:"rgba(211,211,211,1.0)",yellow:"rgba(255,255,0,1.0)",lightgreen:"rgba(144,238,144,1.0)",yellowgreen:"rgba(154,205,50,1.0)",lightgrey:"rgba(211,211,211,1.0)"};function qn(e){var t=e.toLowerCase();if(Hn.hasOwnProperty(t)&&(e=Hn[t]),/^#[a-fA-F0-9]{6}$/.test(e))return e+"FF";if(/^#[a-fA-F0-9]{8}$/.test(e))return e;var n="0123456789ABCDEF";function r(e){return e>255&&(e=255),n[Math.trunc(e/16)]+n[e%16]}var o=/^rgb\(([0-9]+),\s*([0-9]+),\s*([0-9]+)\)$/i.exec(e);if(null!=o)return"#"+r(parseInt(o[1],10))+r(parseInt(o[2],10))+r(parseInt(o[3],10))+"FF";if(null!=(o=/^rgba\(([(0-9]+),\s*([0-9]+),\s*([0-9]+),\s*([01]?[.][0-9]+|[01])\)$/i.exec(e)))return"#"+r(parseInt(o[1],10))+r(parseInt(o[2],10))+r(parseInt(o[3],10))+r(parseFloat(o[4]));d("InvalidArgument: the given Value is not a valid CSS Color specification")}function $n(e){return qn(e).slice(0,7)}var Jn,Gn=Object.freeze({__proto__:null,ColorSet:Hn,FunctionWithName:ee,HTMLsafe:Fn,HexColor:qn,MarkDownSafe:function(e,t){return Fn(e,t).replace(/:/g,"&#58;")},ObjectIsEmpty:zn,ObjectIsNotEmpty:function(e){return!zn(e)},ObjectMergedWith:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,o=t.length;r<o;r++){var i=t[r];if(null!=i)if("object"==typeof i)for(var a in i){var l=Object.getOwnPropertyDescriptor(i,a);null!=l&&Object.defineProperty(e,a,l)}else d("InvalidArgument: argument #"+(r+1)+" is not an object")}return e},Object_hasOwnProperty:c,Object_isPrototypeOf:f,Object_propertyIsEnumerable:function(e,t){return null==e||"propertyIsEnumerable"in e&&"function"==typeof e.propertyIsEnumerable?e.propertyIsEnumerable(t):Object.prototype.propertyIsEnumerable.call(e,t)},Object_toLocaleString:function(e){return null==e||"toLocaleString"in e&&"function"==typeof e.toLocaleString?e.toLocaleString():Object.prototype.toString.call(e)},Object_toString:function(e){return null==e||"toString"in e&&"function"==typeof e.toString?e.toString():Object.prototype.toString.call(e)},Object_valueOf:function(e){return null==e||"valueOf"in e&&"function"==typeof e.valueOf?e.valueOf():Object.prototype.valueOf.call(e)},RGBAColor:function(e){var t=e.toLowerCase();if(Hn.hasOwnProperty(t))return Hn[t];if(/^#[a-fA-F0-9]{6}$/.test(e))return"rgba("+parseInt(e.slice(1,3),16)+","+parseInt(e.slice(3,5),16)+","+parseInt(e.slice(5,7),16)+", 1)";if(/^#[a-fA-F0-9]{8}$/.test(e))return"rgba("+parseInt(e.slice(1,3),16)+","+parseInt(e.slice(3,5),16)+","+parseInt(e.slice(5,7),16)+","+parseInt(e.slice(7),16)/255+")";var n=/^rgb\(([0-9]+),\s*([0-9]+),\s*([0-9]+)\)$/i.exec(e);if(null!=n)return e.slice(0,e.length-1)+",1)";if(null!=(n=/^rgba\(([(0-9]+),\s*([0-9]+),\s*([0-9]+),\s*([0]?[.][0-9]+|[01])\)$/i.exec(e)))return e;d("InvalidArgument: the given Value is not a valid CSS Color specification")},StringIsEmpty:Un,StringIsNotEmpty:function(e){return!Un(e)},ValidatorForClassifier:Y,ValueExists:function(e){return null!=e},ValueInheritsFrom:function(e,t){return f(t,e)},ValueIsAnonymousFunction:E,ValueIsArray:_,ValueIsBoolean:p,ValueIsCardinal:x,ValueIsColor:q,ValueIsDate:D,ValueIsEMailAddress:J,ValueIsEmptyString:function(e){return("string"==typeof e||e instanceof String)&&C.test(e.valueOf())},ValueIsError:R,ValueIsFiniteNumber:v,ValueIsFunction:M,ValueIsInstanceOf:function(e,t){return e instanceof t},ValueIsInteger:b,ValueIsIntegerInRange:function(e,t,n){if(!b(e)||isNaN(e))return!1;if(v(t)){if(v(n)){if(e<t||e>n)return!1}else if(e<t)return!1}else if(v(n)&&e>n)return!1;return!0},ValueIsList:V,ValueIsListSatisfying:F,ValueIsMissing:function(e){return null==e},ValueIsNaN:m,ValueIsNamedFunction:j,ValueIsNativeFunction:N,ValueIsNonEmptyString:O,ValueIsNumber:h,ValueIsNumberInRange:g,ValueIsObject:W,ValueIsOneOf:H,ValueIsOrdinal:y,ValueIsPlainObject:L,ValueIsPromise:z,ValueIsRegExp:U,ValueIsScriptedFunction:k,ValueIsString:w,ValueIsStringMatching:I,ValueIsText:S,ValueIsTextline:T,ValueIsURL:Z,ValueIsVanillaObject:B,ValuesAreEqual:Rn,ValuesDiffer:Dn,acceptNil:Q,allowAnonymousFunction:ut,allowArray:_t,allowBoolean:re,allowCardinal:Le,allowColor:In,allowDate:rn,allowEMailAddress:Tn,allowError:sn,allowFiniteNumber:fe,allowFunction:it,allowInstanceOf:Zt,allowInteger:Oe,allowIntegerInRange:Pe,allowList:Rt,allowListSatisfying:qt,allowNaN:ve,allowNamedFunction:pt,allowNativeFunction:gt,allowNonEmptyString:Ue,allowNumber:le,allowNumberInRange:ye,allowObject:At,allowOneOf:xn,allowOrdinal:je,allowPlainObject:Mt,allowPromise:dn,allowRegExp:mn,allowScriptedFunction:wt,allowString:Fe,allowStringMatching:Je,allowText:Qe,allowTextline:tt,allowURL:Nn,allowValueInheritingFrom:Yt,allowVanillaObject:kt,allowedAnonymousFunction:ct,allowedArray:Vt,allowedBoolean:oe,allowedCardinal:Be,allowedColor:An,allowedDate:on,allowedEMailAddress:Mn,allowedError:un,allowedFiniteNumber:de,allowedFunction:at,allowedInstanceOf:Kt,allowedInteger:Ie,allowedIntegerInRange:Te,allowedList:zt,allowedListSatisfying:$t,allowedNaN:me,allowedNamedFunction:ht,allowedNativeFunction:bt,allowedNonEmptyString:He,allowedNumber:se,allowedNumberInRange:xe,allowedObject:St,allowedOneOf:wn,allowedOrdinal:Ne,allowedPlainObject:Et,allowedPromise:pn,allowedRegExp:gn,allowedScriptedFunction:Ct,allowedString:De,allowedStringMatching:Ge,allowedText:Xe,allowedTextline:nt,allowedURL:kn,allowedValueInheritingFrom:en,allowedVanillaObject:Wt,constrained:function(e,t,n){return void 0===t&&(t=-1/0),void 0===n&&(n=1/0),Math.max(t,Math.min(e,n))},escaped:Bn,expectAnonymousFunction:ft,expectArray:Ft,expectBoolean:ie,expectCardinal:_e,expectColor:Sn,expectDate:an,expectEMailAddress:En,expectError:cn,expectFiniteNumber:pe,expectFunction:lt,expectInstanceOf:Qt,expectInteger:Ae,expectIntegerInRange:Me,expectList:Ut,expectListSatisfying:Jt,expectNaN:ge,expectNamedFunction:vt,expectNativeFunction:yt,expectNonEmptyString:qe,expectNumber:ue,expectNumberInRange:we,expectObject:Pt,expectOneOf:Cn,expectOrdinal:ke,expectPlainObject:jt,expectPromise:hn,expectRegExp:bn,expectScriptedFunction:Ot,expectString:Re,expectStringMatching:Ze,expectText:Ye,expectTextline:rt,expectURL:Wn,expectValue:te,expectValueInheritingFrom:tn,expectVanillaObject:Lt,expectedAnonymousFunction:dt,expectedArray:Dt,expectedBoolean:ae,expectedCardinal:Ve,expectedColor:Pn,expectedDate:ln,expectedEMailAddress:jn,expectedError:fn,expectedFiniteNumber:he,expectedFunction:st,expectedInstanceOf:Xt,expectedInteger:Se,expectedIntegerInRange:Ee,expectedList:Ht,expectedListSatisfying:Gt,expectedNaN:be,expectedNamedFunction:mt,expectedNativeFunction:xt,expectedNonEmptyString:$e,expectedNumber:ce,expectedNumberInRange:Ce,expectedObject:Tt,expectedOneOf:On,expectedOrdinal:We,expectedPlainObject:Nt,expectedPromise:vn,expectedRegExp:yn,expectedScriptedFunction:It,expectedString:ze,expectedStringMatching:Ke,expectedText:et,expectedTextline:ot,expectedURL:Ln,expectedValue:ne,expectedValueInheritingFrom:nn,expectedVanillaObject:Bt,global:u,quotable:_n,quoted:Vn,rejectNil:K,shortHexColor:$n,throwError:d,unescaped:function(e){return e.replace(/\\[0bfnrtv'"\\\/]|\\x[0-9a-zA-Z]{2}|\\u[0-9a-zA-Z]{4}/g,(function(e){switch(e){case"\\0":return"\0";case"\\b":return"\b";case"\\f":return"\f";case"\\n":return"\n";case"\\r":return"\r";case"\\t":return"\t";case"\\v":return"\v";case"\\'":return"'";case'\\"':return'"';case"\\\\":return"\\";default:var t=parseInt(e.slice(2),16);return String.fromCharCode(t)}}))},validatedArgument:X});!function(e){e.Version="0.1.0",e.WAT_Categories=["Applet","Card","Overlay","Control","Compound"],e.WAT_horizontalAnchorings=["left-width","left-right","width-right"],e.WAT_verticalAnchorings=["top-height","top-bottom","height-bottom"],e.WAT_FontWeights=["thin","extra-light","light","normal","medium","semi-bold","bold","extra-bold","heavy","lighter","bolder"];var i=Object.assign(Object.create(null),{thin:100,"extra-light":200,light:300,normal:400,medium:500,"semi-bold":600,bold:700,"extra-bold":800,heavy:900});for(var a in e.WAT_FontStyles=["normal","italic"],e.WAT_TextDecorationLines=["none","underline","overline","line-through"],e.WAT_TextDecorationStyles=["solid","double","dotted","dashed","wavy"],e.WAT_TextAlignments=["left","center","right","justify"],e.WAT_BackgroundModes=["normal","contain","cover","fill","tile"],e.WAT_BorderStyles=["none","dotted","dashed","solid","double","groove","ridge","inset","outset"],e.WAT_Cursors=["alias","all-scroll","auto","cell","context-menu","col-resize","copy","crosshair","default","e-resize","ew-resize","grab","grabbing","help","move","n-resize","ne-resize","nesw-resize","ns-resize","nw-resize","nwse-resize","no-drop","none","not-allowed","pointer","progress","row-resize","s-resize","se-resize","sw-resize","text","vertical-text","w-resize","wait","zoom-in","zoom-out"],e.WAT_Overflows=["visible","hidden","scroll","auto"],e.WAT_TextOverflows=["clip","ellipsis"],Gn)Object.prototype.hasOwnProperty.call(Gn,a)&&(e[a]=Gn[a]);function l(e){return e instanceof HTMLElement}function c(e){return e instanceof yn}function f(e){return e instanceof wn}function h(e){return e instanceof Tn}function m(e){return e instanceof Mn}function b(e){return e instanceof Nn}function x(e){return e instanceof En}function C(e){return e instanceof Nn||e instanceof En}function O(e){return e instanceof An}e.ValueIsElement=l,e.allowElement=Y(l,Q,"DOM element"),e.allowedElement=e.allowElement,e.expectElement=Y(l,K,"DOM element"),e.expectedElement=e.expectElement,e.ValueIsVisual=c,e.allowVisual=Y(c,Q,"WAT visual"),e.allowedVisual=e.allowVisual,e.expectVisual=Y(c,K,"WAT visual"),e.expectedVisual=e.expectVisual,e.ValueIsApplet=f,e.allowApplet=Y(f,Q,"WAT applet"),e.allowedApplet=e.allowApplet,e.expectApplet=Y(f,K,"WAT applet"),e.expectedApplet=e.expectApplet,e.ValueIsCard=h,e.allowCard=Y(h,Q,"WAT card"),e.allowedCard=e.allowCard,e.expectCard=Y(h,K,"WAT card"),e.expectedCard=e.expectCard,e.ValueIsOverlay=m,e.allowOverlay=Y(m,Q,"WAT overlay"),e.allowedOverlay=e.allowOverlay,e.expectOverlay=Y(m,K,"WAT overlay"),e.expectedOverlay=e.expectOverlay,e.ValueIsControl=b,e.allowControl=Y(b,Q,"WAT control"),e.allowedControl=e.allowControl,e.expectControl=Y(b,K,"WAT control"),e.expectedControl=e.expectControl,e.ValueIsCompound=x,e.allowCompound=Y(x,Q,"WAT compound"),e.allowedCompound=e.allowCompound,e.expectCompound=Y(x,K,"WAT compound"),e.expectedCompound=e.expectCompound,e.ValueIsComponent=C,e.allowComponent=Y(C,Q,"WAT component"),e.allowedComponent=e.allowComponent,e.expectComponent=Y(C,K,"WAT component"),e.expectedComponent=e.expectComponent,e.ValueIsContainer=O,e.allowContainer=Y(O,Q,"WAT container"),e.allowedContainer=e.allowContainer,e.expectContainer=Y(O,K,"WAT container"),e.expectedContainer=e.expectContainer;var A=/^wat-[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[89ab][a-f0-9]{3}-[a-f0-9]{12}$/i;function P(e){return w(e)&&A.test(e)}e.ValueIsUniqueId=P,e.allowUniqueId=Y(P,Q,"unique WAT id"),e.allowedUniqueId=e.allowUniqueId,e.expectUniqueId=Y(P,K,"unique WAT id"),e.expectedUniqueId=e.expectUniqueId;var E=/^[a-z][-_a-z.0-9]*$/i;function j(e){return I(e,E)}e.ValueIsId=j,e.allowId=Y(j,Q,"WAT HTML id"),e.allowedId=e.allowId,e.expectId=Y(j,K,"WAT HTML id"),e.expectedId=e.expectId;var N=/^[a-z$_][a-z$_0-9]*(-[a-z$_][a-z$_0-9]*)*$/i;function k(e){return I(e,N)}e.ValueIsName=k,e.allowName=Y(k,Q,"WAT name"),e.allowedName=e.allowName,e.expectName=Y(k,K,"WAT name"),e.expectedName=e.expectName;var W=/^#?[a-z$_][a-z$_0-9]*(-[a-z$_][a-z$_0-9]*)*$/i;function L(e){return I(e,W)}function B(e){return T(e)}e.ValueIsUniversalName=L,e.allowUniversalName=Y(L,Q,"WAT name"),e.allowedUniversalName=e.allowUniversalName,e.expectUniversalName=Y(L,K,"WAT name"),e.expectedUniversalName=e.expectUniversalName,e.ValueIsLabel=B,e.allowLabel=Y(B,Q,"WAT visual label"),e.allowedLabel=e.allowLabel,e.expectLabel=Y(B,K,"WAT visual label"),e.expectedLabel=e.expectLabel;var V=/^[a-z$_][a-z$_0-9]*$/i;function F(e){return I(e,V)}function D(e){return g(e,0,1/0,!0,!1)}function R(e){return v(e)&&e>=0}e.ValueIsIdentifier=F,e.allowIdentifier=Y(F,Q,"WAT identifier"),e.allowedIdentifier=e.allowIdentifier,e.expectIdentifier=Y(F,K,"WAT identifier"),e.expectedIdentifier=e.expectIdentifier,e.ValueIsLocation=D,e.allowLocation=Y(D,Q,"coordinate"),e.allowedLocation=e.allowLocation,e.expectLocation=Y(D,K,"coordinate"),e.expectedLocation=e.expectLocation,e.ValueIsDimension=R,e.allowDimension=Y(R,Q,"extent"),e.allowedDimension=e.allowDimension,e.expectDimension=Y(R,K,"extent"),e.expectedDimension=e.expectDimension;var z=/^(0|[1-9]\d*)(?:[.](0|[1-9]\d*)(?:[.](0|[1-9]\d*)(-[-0-9A-Za-z.]+)?)?)?$/;function U(e){return I(e,z)}function q(e){d("ReadOnlyProperty: property "+Vn(e)+" must not be set")}function $(e){d("WriteOnlyProperty: property "+Vn(e)+" must not be read")}function J(e,t){for(null==e&&d("InvalidArgument: the given target object is null or undefined");null!=e;){var n=Object.getOwnPropertyDescriptor(e,t);if(null!=n)return n;e=Object.getPrototypeOf(e)}}function G(e){return e.replace(/-([a-z])/gi,(function(e){return e[1].toUpperCase()}))}function X(e){return e.replace(/^\s+/,"").replace(/\s+$/,"").replace(/\s+/g," ")}function ee(e,t){Array.prototype.forEach.call(e,t)}function te(e,t){return w(t)?Array.prototype.filter.call(e,(function(e){return e.matches(t)})):Array.prototype.filter.call(e,t)}function ne(e,t){var n=e.parentElement;if(null!=n)return n.closest(t)}function oe(e,t,n){var r=e.parentElement;if(null!=r)for(r=r.closest(t);null!=r;){if(1==n(r))return r;r=r.closest(t)}}function le(e,t,n){if(2===arguments.length)return e.getAttribute(t);null==n?e.removeAttribute(t):e.setAttribute(t,n)}function se(e,t,n){if(2===arguments.length)return window.getComputedStyle(e)[G(t)];e.style[G(t)]=n}function ue(e,t){if(1===arguments.length)return e.innerHTML;e.innerHTML=t}function fe(e,t,n){if(2===arguments.length)return e.dataset[G(t)];e.dataset[G(t)]=n}e.ValueIsSemVer=U,e.allowSemVer=Y(U,Q,"version specification"),e.allowedSemVer=e.allowSemVer,e.expectSemVer=Y(U,K,"version specification"),e.expectedSemVer=e.expectSemVer,e.throwReadOnlyError=q,e.throwWriteOnlyError=$,e.PropertyDescriptorFor=J;var de=new WeakMap;function pe(e,t,n,r){!function(e,t,n,r,o){var i=X(t).split(" "),a=function(e){try{if(null!=n&&!e.target.matches(n))return;!1===r(e)&&(e.stopPropagation(),e.preventDefault())}catch(e){console.error("event handler failed with",e)}o&&he(e.currentTarget,e.type,n,r)},l=de.get(e);null==l&&de.set(e,l=[]),i.forEach((function(t){l.push({EventName:t,Selector:n,actualHandler:a,Handler:r}),e.addEventListener(t,a,!1)}))}(e,t,n,r,!1)}function he(e,t,n,r){var o=void 0;null!=t&&(o=X(t).split(" "));var i=de.get(e);if(null!=i)for(var a=i.length;a>=0;a--){var l=i[a];!(null==o||o.indexOf(l.EventName)>=0)||null!=n&&l.Selector!==n||null!=r&&l.Handler!==r||(e.removeEventListener(l.EventName,l.actualHandler),i.splice(a,1))}}function ve(e){switch(!0){case l(e):var t=e.parentElement;null!=t&&t.removeChild(e);break;case _(e):e.forEach((function(e){return ve(e)}));break;default:ee(e,(function(e){return ve(e)}))}}function me(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild}function ge(e,t){var n=/^<([-a-z0-9_]+)((?:[\s\xA0]+[-a-z0-9_]+(?:[\s\xA0]*=[\s\xA0]*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s\xA0]+))?)*)[\s\xA0]*(\/?)>/i,r=/^<\/([-a-z0-9_]+)[^>]*>/i,o=/([-a-z0-9]+)(?:[\s\xA0]*=[\s\xA0]*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s\xA0]+)))?/gi;function i(e){for(var t=e.split(","),n=Object.create(null),r=0,o=t.length;r<o;r++)n[t[r]]=!0;return n}var a=i("area,base,basefont,br,col,embed,frame,hr,img,input,isIndex,keygen,link,meta,param,source,track,wbr"),l=i("address,article,aside,audio,blockquote,canvas,center,dd,dir,div,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,isIndex,li,main,menu,nav,noframes,noscript,ol,output,p,pre,section,table,tbody,td,tfoot,th,thead,tr,ul,video,applet"),s=i("a,abbr,acronym,Applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,Object,q,s,samp,Script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),u=i("area,base,basefont,bgsound,br,col,colgroup,dd,dt,embed,frame,hr,img,input,isIndex,keygen,li,link,menuitem,meta,options,p,param,source,td,tfoot,th,thead,tr,track,wbr"),c=i("script,style,svelte:options"),f=i("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),p=function(){},h=t.processStartTag||p,v=t.processEndTag||p,m=t.processText||p,g=t.processComment||p,b=[];function y(e,t,n,r){if(t=t.toLowerCase(),l[t])for(;null!=b.last()&&s[b.last()];)x("",b.last());if(u[t]&&b.last()===t&&x("",t),(r=a[t]||!!r)||b.push(t),h!==p){var i=[];n.replace(o,(function(e,t){var n=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:f[t]?t:"";return i.push({Name:t,Value:n,escapedValue:n.replace(/(^|[^\\])"/g,'$1\\"')}),""})),h(t,i,r,b.length===(r?0:1))}return""}function x(e,t){var n;if(null==t)n=0;else for(t=t.toLowerCase(),n=b.length-1;n>=0&&b[n]!==t;n--);if(n>=0){for(var r=b.length-1;r>=n;r--)v(b[r],0===r);b.length=n}return""}b.last=function(){return this[this.length-1]};for(var w=e;""!==e;){var C=!0;if(null!=b.last()&&c[b.last()])e=e.replace(new RegExp("^((?:.|\n)*?)</"+b.last()+"[^>]*>","i"),(function(e,t){return t=t.replace(/<!--(.*?)-->/g,"$1").replace(/<!\[CDATA\[(.*?)]]>/g,"$1"),m(t,0===b.length),""})),x(0,b.last());else{if(e.startsWith("\x3c!--"))(I=e.indexOf("--\x3e",4))>0&&(g(e.slice(4,I)),e=e.slice(I+3),C=!1);else if(e.startsWith("</")){null!=(O=e.match(r))&&(e=e.slice(O[0].length),O[0].replace(r,x),C=!1)}else if(e.startsWith("<")){var O;null!=(O=e.match(n))&&(e=e.slice(O[0].length),O[0].replace(n,y),C=!1)}if(C){var I,A=(I=e.indexOf("<"))<0?e:e.slice(0,I);e=I<0?"":e.slice(I),m(A,0===b.length)}}if(e===w)switch(!0){case e.startsWith("<"):e=e.slice(1),m("&lt;",0===b.length);break;default:d('HTMLParseError: could not parse "'+e+'"')}w=e}x()}function be(e,t){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(o.Name===e)return o.Value}}function xe(e,t,n){for(var r="<"+e,o=0,i=t.length;o<i;o++){var a=t[o];r+=" "+a.Name+'="'+a.escapedValue+'"'}return r+(n?"/>":">")}var Oe=/^(\d+)(?:[.](\d+)(?:[.](\d+)(-[-0-9A-Za-z.]+)?)?)?$/;function Ie(e){var t=Oe.exec(e);return{major:parseInt(t[1],10),minor:null==t[2]?void 0:parseInt(t[2],10),Patch:null==t[3]?void 0:parseInt(t[3],10),Build:null==t[4]?void 0:parseInt(t[4].slice(1),16)}}function Ae(e){var t=e.major,n=e.minor,r=e.Patch;e.Build;return 1,{major:t,minor:n=n||0,Patch:r=r||(0===t&&0===n?1:0),Build:1}}var Se=new Date("2020-02-02").getTime();function Te(){return Date.now()-Se}var Me,Ne=new WeakMap;function We(e){Ye("resource",e),Be(e||"","register")}function Le(e){Qe("resource",e),null!=e&&Be(e||"","unregister")}function Be(e,t){""!==e.trim()&&function(e){var t,n,r=[];function o(e){for(var t={},n=0,r=e.length;n<r;n++)t[e[n].Name.toLowerCase()]=e[n];return t}function i(e){r.forEach((function(t){!function(e,t){if(e.Form!==t.Form)return!1;switch(e.Form){case"literalStyle":case"externalStyle":return e.Type===t.Type&&e.Media===t.Media&&e.Title===t.Title&&(e.Value||"").trim()===(t.Value||"").trim();case"literalScript":case"externalScript":return e.Type===t.Type&&e.noModule===t.noModule&&(e.Value||"").trim()===(t.Value||"").trim();default:d("InternalError: unforeseen resource form")}}(t,e)?r.push(e):d("DuplicateResources: the given set of resources contains duplicates")}))}return ge(e,{processStartTag:function(e,r,a,l){if(l){switch(e){case"link":if(be("rel",r)==="stylesheet"){i({Form:"externalStyle",Type:be("type",r)||"text/css",Media:be("media",r)||"all",Title:be("title",r)||undefined,Value:be("href",r),AttributeSet:o(r)})}return;case"script":case"style":t=o(r);n="";return;default:d("InvalidResourceSet: a WAT resource set must only contain "+"style, script or link elements (the latter only with "+'relation "stylesheet")')}}else{if(n!==undefined){n+=xe(e,r,a)}}},processEndTag:function(e,r){if(r){switch(e){case"script":i({Form:t.src==null?"literalScript":"externalScript",Type:(t===null||t===void 0?void 0:t.type.Value)||"application/javascript",noModule:"nomodule"in t,Value:t.src==null?n:t.src.Value,AttributeSet:t});break;case"style":i({Form:"literalStyle",Type:(t===null||t===void 0?void 0:t.type.Value)||"text/css",Media:(t===null||t===void 0?void 0:t.media.Value)||"all",Title:(t===null||t===void 0?void 0:t.title.Value)||undefined,Value:n,AttributeSet:t})}t={};n=undefined}else{if(n!==undefined){n+="</"+e+">"}}},processText:function(e,t){if(n!==undefined){n+=e}}}),r}(e).forEach((function(e){!function(e,t){var n,r=function(e){var t=void 0;return te(document.head.children,"link,style,script").forEach((function(n){(function(e,t){switch(e.Form){case"literalStyle":return"STYLE"===t.tagName&&"text/css"===(le(t,"type")||"text/css")&&(le(t,"media")||"all")===e.Media&&(le(t,"title")||void 0)===e.Title&&(t.textContent||"").trim()===e.Value;case"externalStyle":return"LINK"===t.tagName&&"stylesheet"===le(t,"rel")&&"text/css"===(le(t,"type")||"text/css")&&(le(t,"media")||"all")===e.Media&&(le(t,"title")||void 0)===e.Title&&le(t,"href")===e.Value;case"literalScript":return"SCRIPT"===t.tagName&&(null==le(t,"type")||"application/javascript"===le(t,"type")||"text/javascript"===le(t,"type"))&&(le(t,"nomodule")||!1)===e.noModule&&(t.textContent||"").trim()===e.Value;case"externalScript":return"SCRIPT"===t.tagName&&(null==le(t,"type")||"application/javascript"===le(t,"type")||"text/javascript"===le(t,"type"))&&(le(t,"nomodule")||!1)===e.noModule&&le(t,"src")===e.Value;default:d("InternalError: unforeseen resource form")}})(e,n)&&(t=n)})),t}(e);if(null==r)switch(t){case"register":break;case"unregister":return;case"collect":d("NoSuchResource: an expected resource has already been removed")}else switch(t){case"register":return void function(e){Ne.set(e,(Ne.get(e)||0)+1)}(r);case"unregister":return void function(e){Ne.set(e,Math.max(0,(Ne.get(e)||0)-1))}(r);case"collect":return void function(e){for(var t=0,n=Me.length;t<n;t++)if(Me[t]===e)return;Me.push(e)}(r)}switch(e.Form){case"literalStyle":ue(n=me("<style></style>"),e.Value||"");break;case"externalStyle":n=me("<link></link>");break;case"literalScript":ue(n=me("<script><\/script>"),e.Value||"");break;case"externalScript":n=me("<script><\/script>");break;default:d("InternalError: unforeseen resource form")}var o=e.AttributeSet||{};for(var i in o)o.hasOwnProperty(i)&&le(n,i,o[i].Value);switch(e.Form){case"literalStyle":case"externalStyle":document.head.appendChild(n);break;case"literalScript":try{document.head.appendChild(n)}catch(e){throw console.warn("could not attach literal script",e),e}break;case"externalScript":document.head.appendChild(n);break;default:d("InternalError: unforeseen resource form")}Ne.set(n,1)}(e,t)}))}e.registerResources=We,e.unregisterResources=Le;var _e,Ve=!1;try{s.config({driver:[s.INDEXEDDB,s.WEBSQL]}),Ve=!0}catch(e){}function De(){return null!=_e}function Re(e){return n(this,void 0,void 0,(function(){var t,n,o,i,a;return r(this,(function(r){switch(r.label){case 0:switch(!0){case f(e):if(null==(t=e.Name))return[2,!1];break;case l(e):if(!k(n=fe(e,"wat-name")))return[2,!1];t=n;break;default:d("InvalidArgument: applet or applet name expected")}if(!De())return[2,!1];r.label=1;case 1:return r.trys.push([1,3,,4]),o=t.startsWith("#")?t.slice(1):t,i=w,[4,_e.getItem(o)];case 2:return[2,i.apply(void 0,[r.sent()])];case 3:return a=r.sent(),console.error('backup of applet "'+t+" could not be checked, reason: ",a),[2,!1];case 4:return[2]}}))}))}function ze(t){return n(this,void 0,void 0,(function(){var n,o,i,a;return r(this,(function(r){switch(r.label){case 0:e.expectElement("applet peer",t),k(n=fe(t,"wat-name"))||d("InvalidArgument: the given applet peer does not have a valid name"),r.label=1;case 1:return r.trys.push([1,3,,4]),i=n.startsWith("#")?n.slice(1):n,[4,_e.getItem(i)];case 2:return o=r.sent(),[3,4];case 3:return a=r.sent(),console.error('applet "'+n+" could not be restored, reason: ",a),d("applet could not be restored (see browser console)"),[3,4];case 4:return Ge(o,t),[2,nn(t)]}}))}))}function Ue(e){switch(De()||d("NotSupported: WAT applets can not be preserved in this environment"),k(e.Name)||d("InvalidArgument: the given applet does not have a valid name"),an(e).BackupStatus){case"isBeingPreserved":d("ForbiddenOperation: this applet is currently being backed-up");case"isBeingRestored":d("ForbiddenOperation: this applet is currently being restored from its backup");case"isBeingRemoved":d("ForbiddenOperation: the backup of this applet is currently being removed")}}function He(t,n){e.expectName("master name",t);var r=gt[t];function o(e){e.split(" ").forEach((function(e){var t=r[e];null!=t&&(w(t)&&""!==t||_(t)&&t.length>0)&&(i[e]=t)}))}null==r&&d("NoSuchMaster: no master named "+Vn(t)+" found");var i={};o("Name Version Category Resources Template Classes Styles Script Properties");var a=[];for(var l in r.undesignablePropertySet)a.push(l);return i.undesignableProperties=a.join(" "),"withPendingSettings"===n&&o("pendingResources pendingTemplate pendingClasses pendingStyles pendingScript"),'<script type="application/wat-master">\n'+JSON.stringify(i)+"\n<\/script>"}function qe(e,t,n){function r(t){switch(e.trigger(t),e.Category){case"Applet":e.CardList.forEach((function(e){return e.trigger(t)}))(e).OverlayList.forEach((function(e){return e.trigger(t)}));break;case"Card":case"Overlay":case"Compound":e.ComponentList.forEach((function(e){return e.trigger(t)}))}}r("before-serialization"),t&&function e(t){var n=tn.get(t);le(t,"data-wat-unique-id",on.get(n).uniqueId),te(t.children,".WAT.Card,.WAT.Overlay,.WAT.Control,.WAT.Compound").forEach((function(t){e(t)}))}(e.Peer);var o=e.Peer.outerHTML;return t&&function e(t){le(t,"data-wat-unique-id",void 0),te(t.children,".WAT.Card,.WAT.Overlay,.WAT.Control,.WAT.Compound").forEach((function(t){e(t)}))}(e.Peer),r("after-serialization"),o}function $e(e){Ye("serialization",e);var t,n,r=[],o=[],i=[],a=[],l=[],s=[];return ge(e,{processStartTag:function(e,o,i,a){if(a)switch(e){case"link":"stylesheet"===be("rel",o)&&Z(be("href",o))?r.push(xe(e,o,i)):d('InvalidSerialization: invalid "link" element encountered');break;case"style":var l=be("type",o);null==l||"text/css"===l?(t="literalStyle",n=xe(e,o,!1)):d('InvalidSerialization: invalid "style" element encountered');break;case"script":switch(be("type",o)){case"application/wat-master":t="Master",n=xe(e,o,!1);break;case"application/javascript":case"text/javascript":t=null==be("src",o)?"literalScript":"externalScript",n=xe(e,o,!1);break;default:d('InvalidSerialization: invalid "script" element encountered')}break;case"div":var s=be("class",o)||"";if(/(^|\s)WAT(\s|$)/.test(s)){switch(!0){case/(^|\s)Applet(\s|$)/.test(s):t="Applet";break;case/(^|\s)Card(\s|$)/.test(s):t="Card";break;case/(^|\s)Overlay(\s|$)/.test(s):t="Overlay";break;case/(^|\s)(Control|Compound)(\s|$)/.test(s):t="Component";break;default:d('InvalidSerialization: invalid "div" element encountered')}n=xe(e,o,!1)}else d('InvalidSerialization: invalid "div" element encountered');default:d('InvalidSerialization: invalid "'+e.toLowerCase()+'" element encountered')}else void 0!==n&&(n+=xe(e,o,i))},processEndTag:function(e,u){if(u){switch(n+="</"+e+">",e){case"style":r.push(n);break;case"script":switch(t){case"Master":o.push(n);break;case"literalScript":case"externalScript":r.push(n)}break;case"div":switch(n+="</"+e+">",t){case"Applet":i.push(n);break;case"Card":a.push(n);break;case"Overlay":l.push(n);break;case"Component":s.push(n)}}t=n=void 0}else void 0!==n&&(n+="</"+e+">")},processText:function(e,t){void 0!==n&&(n+=e)}}),{serializedResources:r,serializedMasters:o,serializedApplets:i,serializedCards:a,serializedOverlays:l,serializedComponents:s}}function Je(e){var t;Ye("serialization",e);try{t=JSON.parse(e)}catch(e){d("InvalidSerialization: the given serialized master does not contain a master specification")}return yt(t)}function Ge(e,t,n){var r=$e(e),o=r.serializedMasters,i=r.serializedApplets;if(0===i.length&&d("InvalidSerialization: the given serialization does not contain any applets"),i.length>1&&d("InvalidSerialization: the given serialization contains multiple applets"),Ln&&!Fn)ue(t,"");else{var a=nn(t);a.CardList.forEach((function(e){return e.remove()})),a.OverlayList.forEach((function(e){return e.remove()})),ue(t,""),on.delete(a)}if(o.length>0){var l=[];o.forEach((function(e){return l.push(Je(e))})),l.forEach((function(e){At(e.Name)||St(e)}))}for(var s=me(i[0]);s.hasChildNodes();)t.appendChild(s.firstChild);for(var u=s.attributes,c=0,f=u.length;c<f;c++){var p=u[c].name;switch(p){case"id":case"class":case"style":break;default:le(t,p,u[c].value)}}var h=s.style;for(var v in h)switch(v){case"display":case"position":case"left":case"width":case"right":case"top":case"height":case"bottom":break;default:h.hasOwnProperty(v)&&se(t,v,h[v])}cn(t,"Applet")}e.AppletsMayBePreserved=De,e.AppletMayBePreserved=function(t){return e.expectApplet("applet",t),De()&&k(t.Name)&&null!=an(t)&&null==an(t).BackupStatus},e.AppletHasBackup=Re,e.preserveApplet=function(t){return n(this,void 0,void 0,(function(){var n,o,i,a;return r(this,(function(r){switch(r.label){case 0:e.expectApplet("applet",t),Ue(t),n=an(t),r.label=1;case 1:return r.trys.push([1,3,,4]),o=t.Name.startsWith("#")?t.Name.slice(1):t.Name,n.BackupStatus="isBeingPreserved",i=function(e,t,n,r,o){var i="";if(r||o){null==r&&(r="withUsedMasters");var a=void 0;if(a="withUsedMasters"===r?zt(e,"withoutIntrinsics"):function(){var e=Object.create(null);ee(document.head.querySelectorAll('script[type="application/wat-master"]'),(function(t){try{var n=bt(t).Name;k(n)&&n in gt&&(e[n]=n)}catch(e){}}));var t=[];for(var n in e)t.push(n);return t}(),o){var l=[];a.forEach((function(e){var t=gt[e];null!=t&&null!=t.Resources&&l.push(t.Resources)})),l.length>0&&(i+=(Me=[],l.forEach((function(e){return Be(e,"collect")})),function(){for(var e="",t=0,n=Me.length;t<n;t++)e+=Me[t].outerHTML+"\n";return e}()+"\n"))}i+=function(e,t){var n=[];return e.forEach((function(e){e in gt&&n.push(He(e,t))})),n.join("\n")}(a,n)+"\n"}return e.forEach((function(e){return i+=qe(e,t)})),i}([t],void 0,"withPendingSettings","withAllMasters"),[4,_e.setItem(o,i)];case 2:return r.sent(),delete n.BackupStatus,[3,4];case 3:return a=r.sent(),delete n.BackupStatus,console.error('applet "'+t.Name+" could not be preserved, reason: ",a),d("applet could not be preserved (see browser console)"),[3,4];case 4:return[2]}}))}))},e.restoreApplet=function(t,o){return n(this,void 0,void 0,(function(){var n,o,i,a,l;return r(this,(function(r){switch(r.label){case 0:e.expectApplet("applet",t),n=t.Name,Ue(t),i=an(t),r.label=1;case 1:return r.trys.push([1,3,,4]),a=n.startsWith("#")?n.slice(1):n,i.BackupStatus="isBeingRestored",[4,_e.getItem(a)];case 2:return o=r.sent(),delete i.BackupStatus,[3,4];case 3:return l=r.sent(),delete i.BackupStatus,console.error('applet "'+n+" could not be restored, reason: ",l),d("applet could not be restored (see browser console)"),[3,4];case 4:return Ge(o,t.Peer),[2]}}))}))},e.removeBackupOfApplet=function(t){return n(this,void 0,void 0,(function(){var n,o,i;return r(this,(function(r){switch(r.label){case 0:e.expectApplet("applet",t),Ue(t),n=an(t),r.label=1;case 1:return r.trys.push([1,3,,4]),o=t.Name.startsWith("#")?t.Name.slice(1):t.Name,n.BackupStatus="isBeingRemoved",[4,_e.removeItem(o)];case 2:return r.sent(),delete n.BackupStatus,[3,4];case 3:return i=r.sent(),delete n.BackupStatus,console.error('applet "'+t.Name+" could not be removed, reason: ",i),d("applet could not be removed (see browser console)"),[3,4];case 4:return[2]}}))}))},e.serializedMaster=He,e.parsedSerialization=$e,e.deserializedMaster=Je,e.AppletDeserializedFrom=function(t,n){e.expectApplet("applet",t),Ye("serialization",n);var r=t.Peer;return Ge(n,r),nn(r)};var Ze="\n    uniqueId Id Name Label Category Master ErrorInfo mayBeDesigned mayBeDeleted\n    Classes isVisible isEnabled Value Script pendingScript pendingScriptError\n    TabIndex PointerSensitivity Overflows TextOverflow Opacity\n    x y Width Height Position Size Geometry GeometryOnDisplay\n    horizontalAnchoring verticalAnchoring horizontalOffsets verticalOffsets\n    minWidth maxWidth minHeight maxHeight\n    FontFamily FoltSize FontWeight FontStyle TextDecoration TextShadow\n    TextAlignment ForegroundColor Color BackgroundColor BackgroundTexture\n    BorderWidths BorderColors BorderStyles BorderRadii BoxShadow\n    Cursor customCursor\n  ".trim().replace(/\s+/g," ").split(" "),et=Object.create(null);function rt(t,n){jt(t,n);var r=n.Identifier;F(r)||d("InvalidArgument: invalid property name "+Vn(r)),ut(r);var o=n.Label;switch(!0){case null==o:o=r;break;case T(o):o=o.trim()||r;break;default:d("InvalidArgument: the label of property "+Vn(r)+" does not consist of a single line of text")}var i=n.EditorType;switch(!0){case null==i:d("InvalidArgument: missing editor type for property "+Vn(r));case!H(i,e.WAT_PropertyEditorTypes):d("InvalidArgument: invalid editor type given for property "+Vn(r))}var a,l={Identifier:r,Label:o,EditorType:i};switch(i){case"checkbox":break;case"choice":l.FalseValue=ot('label for value "false"',n.FalseValue),l.TrueValue=ot('label for value "true"',n.TrueValue);break;case"textline-input":case"password-input":case"email-address-input":case"phone-number-input":case"url-input":case"search-input":null!=n.minLength&&(l.minLength=Ee("minimal input length",n.minLength,0)),null!=n.maxLength&&(l.maxLength=Ee("maximal input length",n.maxLength,0)),null!=n.multiple&&"email-address-input"===i&&(l.multiple=ae("multi-value flag",n.multiple)),null!=n.Pattern&&(l.Pattern=ot("input pattern",n.Pattern));break;case"number-input":null!=n.minValue&&(l.minValue=ce("minimal allowed value",n.minValue)),null!=n.maxValue&&(l.maxValue=ce("maximal allowed value",n.maxValue)),null!=n.StepValue&&("any"===n.StepValue?l.StepValue="any":l.StepValue=Ce("step value",n.StepValue,0,1/0,!1));break;case"time-input":a=/^[0-9]{2}:[0-9]{2}$/;case"date-time-input":a=/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}$/;case"date-input":a=a||/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/;case"month-input":a=a||/^[0-9]{4}-[0-9]{2}$/;case"week-input":a=a||/^[0-9]{4}-W[0-9]{2}$/,null!=n.minValue&&(l.minValue=Ke("minimal allowed value",n.minValue,a)),null!=n.maxValue&&(l.maxValue=Ke("maximal allowed value",n.maxValue,a)),null!=n.StepValue&&("any"===n.StepValue?l.StepValue="any":l.StepValue=Ee("step value",n.StepValue,0));break;case"color-input":break;case"drop-down":l.ValueList=Dt("list of allowed values",n.ValueList);for(var s=0,u=l.ValueList.length;s<u;s++)T(l.ValueList[s])||d("InvalidArgument: element #"+(s+1)+" of the list of foreseen drop-down values is not a valid line of text");break;case"slider":null!=n.minValue&&(l.minValue=ce("minimal allowed value",n.minValue)),null!=n.maxValue&&(l.maxValue=ce("maximal allowed value",n.maxValue)),null!=n.StepValue&&("any"===n.StepValue?l.StepValue="any":l.StepValue=Ce("step value",n.StepValue,0,1/0,!1));break;case"text-input":case"html-input":case"css-input":case"javascript-input":case"json-input":null!=n.minLength&&(l.minLength=Ee("minimal input length",n.minLength,0)),null!=n.maxLength&&(l.maxLength=Ee("maximal input length",n.maxLength,0))}return l}function ut(e){e in xt&&d("InvalidArgument: forbidden property name "+Vn(e))}function ct(t,n,r){e.expectIdentifier("property name",n),it("property getter",r);var o=J(t,n);null==o?o={get:r,set:function(){q(n)},configurable:!0,enumerable:!0}:("function"==typeof o.value&&d("InvalidProperty: method "+Vn(n)+" must not be redefined as a property"),0==o.configurable&&d("InvalidProperty: property "+Vn(n)+" cannot be redefined"),delete o.value,delete o.writable,o.get=r,o.set=o.set||function(){q(n)}),Object.defineProperty(t,n,o)}function ft(t,n,r){e.expectIdentifier("property name",n),it("property setter",r);var o=J(t,n);null==o?o={get:function(){$(n)},set:r,configurable:!0,enumerable:!0}:("function"==typeof o.value&&d("InvalidProperty: method "+Vn(n)+" must not be redefined as a property"),0==o.configurable&&d("InvalidProperty: property "+Vn(n)+" cannot be redefined"),delete o.value,delete o.writable,o.get=o.get||function(){$(n)},o.set=r),Object.defineProperty(t,n,o)}function dt(e){var t=e.parentElement;return null==t&&d("ImpossibleOperation: a detached visual can not be right or bottom aligned"),t}function pt(e){var t=ln(e);return{x:t.offsetLeft,Width:t.offsetWidth,y:t.offsetTop,Height:t.offsetHeight}}function ht(e,t,n,r,o){var i,a,l,s,u,c,f,d,p=ln(e),h={};function v(e){Object.assign(h,e)}if(null==t&&null==r||(i=vt(e),a=Math.round(p.offsetLeft),l=Math.round(p.offsetWidth)),null!=t){s="left-width"===i?NaN:dt(p).offsetWidth-a-l;var m=(t=Math.round(t))-a;switch(i){case"left-width":v({left:t+"px"});break;case"width-right":v({right:s-m+"px"});break;case"left-right":v({left:t+"px",right:s-m+"px"})}}if(null!=r&&(r=Math.round(r),v("left-right"===i?{right:(s=null!=h.right?parseFloat(h.right):dt(p).offsetWidth-a-l)-(r-l)+"px"}:{width:r+"px"})),null==n&&null==o||(u=mt(e),c=Math.round(p.offsetTop),f=Math.round(p.offsetHeight)),null!=n){d="top-height"===u?NaN:dt(p).offsetHeight-c-f;var g=(n=Math.round(n))-c;switch(u){case"top-height":v({top:n+"px"});break;case"height-bottom":v({bottom:d-g+"px"});break;case"top-bottom":v({top:n+"px",bottom:d-g+"px"})}}null!=o&&(o=Math.round(o),v("top-bottom"===u?{bottom:(d=null!=h.bottom?parseFloat(h.bottom):dt(p).offsetHeight-c-f)-(o-f)+"px"}:{height:o+"px"})),zn(h)||mn(e,h)}function vt(e){var t=ln(e),n=t.style.left||"auto",r=t.style.right||"auto",o=t.style.width||"auto";return"auto"===r?"left-width":"auto"===o?"left-right":"auto"===n?"width-right":(console.error("could not determine horizontal anchors of given Visual\ngot left:"+n+", right:"+r+", width:"+o),"left-width")}function mt(e){var t=ln(e),n=t.style.top||"auto",r=t.style.bottom||"auto",o=t.style.height||"auto";return"auto"===r?"top-height":"auto"===o?"top-bottom":"auto"===n?"height-bottom":(console.error("could not determine vertical anchors of given Visual\ngot top:"+n+", bottom:"+r+", height:"+o),"top-height")}Ze.forEach((function(e){return et[e]=e}));var gt=Object.create(null);function bt(e){return yt(JSON.parse(ue(e)))}function yt(t){jt("master specification",t);var n=e.expectedName("master name",t.Name);n.startsWith("#")&&d("InvalidImport: the name of a master must not be global");var r=Ae(Ie(e.allowedSemVer("master version",t.Version)||"0.0.1")),o=On("master category",t.Category,e.WAT_Categories),i=Xe("master resources",t.Resources);null!=i&&""===i.trim()&&(i=null);var a=Xe("pending master resources",t.pendingResources);null!=a&&""===a.trim()&&(a=null);var l=Xe("master template",t.Template);null!=l&&""===l.trim()&&(l='<div class="WAT '+n+'"></div>');var s=Xe("pending master template",t.pendingTemplate);null!=s&&""===s.trim()&&(s=null);var u=wt(t.Classes),c=nt("pending master classes",t.pendingClasses),f=Ct(t.Styles),p=Xe("pending master CSS styles",t.pendingStyles),h=Xe("master script",t.Script),v=Xe("pending master script",t.pendingScript),m=function(e){if(_t("list of custom properties",e),null==e||0===e.length)return[];var t=[],n=Object.create(null);return e.forEach((function(e){var r=rt("property specification",e);t.push(n[r.Identifier]=r)})),t}(t.Properties),g=function(t){Qe("list of undesignable properties",t);var n=Object.create(null);if(null==t)return n;return t.trim().replace(/\s+/g," ").split(" ").forEach((function(t){e.allowIdentifier("name of an undesignable property",t),n[t]=t})),n}(t.undesignableProperties),b="plain"+o;if(n!==b)for(var y in gt[b].undesignablePropertySet)g[y]=y;return{Name:n,Version:r,Category:o,Resources:i,pendingResources:a,Template:l,pendingTemplate:s,Classes:u,pendingClasses:c,Styles:f,pendingStyles:p,Script:h,pendingScript:v,Properties:m,undesignablePropertySet:g,ErrorInfo:void 0,compiledScript:void 0,UsageCount:0}}e.WAT_PropertyEditorTypes=["checkbox","choice","textline-input","password-input","number-input","search-input","phone-number-input","email-address-input","url-input","time-input","date-time-input","date-input","month-input","week-input","color-input","drop-down","slider","text-input","html-input","css-input","javascript-input","json-input"];var xt=Object.create(null);function wt(e){if(Qe("master class presets",e),null==e)return[];var t=e.trim().replace(/\s+/g," ").split(" ");return 0===t.length?[]:(t.forEach((function(e){k(e)||d("InvalidSpecification: master specification contains invalid class name "+Vn(e))})),t)}function Ct(e){var t;if(Qe("master style presets",e),null!=e&&""!==(e=e.trim())){var n=document.createElement("style");n.textContent="#"+Math.round(9999*Math.random())+" {"+e+"}",document.implementation.createHTMLDocument("").body.appendChild(n);for(var r=(null===(t=n.sheet)||void 0===t?void 0:t.cssRules[0]).style,o=Object.create(null),i=0,a=r.length;i<a;i++){var l=r[i],s=r.getPropertyValue(l);o[l]=s}return o}}function Ot(e,t){var n=e.Name;if(At(n)&&d("ForbiddenRegistration: intrinsic master "+Vn(n)+" must not be replaced"),n in gt){var r=function(e,t){switch(!0){case function(e,t){return e.major===t.major&&(e.minor||0)===(t.minor||0)&&(e.Patch||0)===(t.Patch||0)&&(e.Build||1)===(t.Build||1)}(e,t):return"sameVersion";case e.major<t.major:return"incompatibleDowngrade";case e.major>t.major:return"incompatibleUpgrade";case 0===e.major&&e.minor<t.minor:return"incompatibleDowngrade";case 0===e.major&&e.minor>t.minor:return"incompatibleUpgrade";case 0===e.major&&e.Patch<t.Patch:return"incompatibleDowngrade";case 0===e.major&&e.Patch>t.Patch:return"compatibleUpgrade";case 0===e.major&&e.Build<t.Build:return"compatibleDowngrade";case 0===e.major&&e.Build>t.Build:return"compatibleUpgrade";case e.minor<t.minor:return"incompatibleDowngrade";case e.minor>t.minor:return"compatibleUpgrade";case e.Patch<t.Patch:return"compatibleDowngrade";case e.Patch>t.Patch:return"compatibleUpgrade";case e.Build<t.Build:return"compatibleDowngrade";case e.Build>t.Build:return"compatibleUpgrade";default:d("InternalError: unforeseen version relationship")}}(e.Version,gt[n].Version);switch(t[r]){case"perform":return!0;case"ignore":return!1;case"abort":switch(r){case"compatibleDowngrade":d("ForbiddenImport: this import would result in a downgrade of master "+Vn(n));case"incompatibleDowngrade":d("ForbiddenImport: this import would result in an incompatible downgrade of master "+Vn(n));case"sameVersion":d("ForbiddenImport: this import would overwrite master "+Vn(n));case"compatibleUpgrade":d("ForbiddenImport: this import would result in an upgrade of master "+Vn(n));case"incompatibleUpgrade":d("ForbiddenImport: this import would result in an incompatible upgrade of master "+Vn(n))}}return!1}return!0}var It=Object.create(null);function At(e){return null!=It[e]}function St(e){At(e.Name)&&d("ForbiddenOperation: an intrinsic master must not be (re-)registered"),e.ErrorInfo=void 0,null!=e.Resources&&We(e.Resources),null!=e.Script&&Et(e.Script,e),e.UsageCount=0;var t=e.Name;gt[t]=e,Fn&&Nt(t)}function Tt(e){(At(e)&&d("ForbiddenOperation: an intrinsic master must not be unregistered"),e in gt)&&(null!=gt[e].Resources&&Le(gt[e].Resources),function(e){var t=gt[e];if(null==t)return;he(document.body,"mousedown mousemove mouseup","."+e),he(document.body,"mouseenter mouseleave","."+e),he(document.body,"keydown keypress keyup","."+e),he(document.body,"input change click","."+e);var n=t.Resources;null!=n&&Le(n)}(e),delete gt[e],Fn&&Nt(e))}function Et(e,t){if(delete t.compiledScript,null!=e)try{t.compiledScript=new Function("toGet","toSet","on","off","trigger","$",e)}catch(e){t.ErrorInfo={Title:"Compilation Error",longMessage:"Script of Master "+Vn(t.Name)+" could not be compiled",shortMessage:e.message,Reason:e,Applet:(n=kn()[0],nn(n)),Sufferer:t.Name,Property:"Script"}}var n}function Nt(e){Fn&&ee(document.body.querySelectorAll('.WAT[data-wat-master="'+e+'"]'),(function(e){return gn(nn(e))}))}function kt(t){e.expectName("master name",t);var n=gt[t];return null==n&&d("NoSuchMaster: a master with the name "+Vn(t)+" does not exist"),n}function Wt(t,n,r){void 0===r&&(r=!0),e.expectName("new master name",n),re("master instance update setting",r);var o=kt(t);t!==n&&(null!=gt[n]&&d("MasterExists: a master with the name "+Vn(n)+" exists already"),delete gt[t],o.Name=n,o.Version.Build=Te(),gt[n]=o,r?(ee(document.body.querySelectorAll('.WAT[data-wat-master="'+t+'"]'),(function(e){fe(e,"wat-master",n)})),Fn&&Nt(n)):Fn&&(Nt(t),Nt(n)))}function Lt(e){return null==e?"":e.join(" ")}function Bt(e){var t="";if(null!=e)for(var n in e)e.hasOwnProperty(n)&&(t+=n+":"+e[n]+"; ");return t}function Vt(t,n){if(e.allowIdentifier("property name",n),n in xt)return!1;var r=kt(t).Properties;if(null!=r)for(var o=0,i=r.length;o<i;o++){if(r[o].Identifier===n)return!0}return!1}function Ft(t,n,r){if(e.expectIdentifier("old property identifier",n),e.expectIdentifier("new property identifier",r),ut(n),ut(r),n!==r){var o=Rt(t,n);o<0&&d("NoSuchProperty: a property with the name "+Vn(n)+" does not exist"),Rt(t,r)>=0&&d("PropertyExists: a property with the name "+Vn(r)+" exists already"),gt[t].Properties[o].Identifier=r}}function Rt(t,n){e.expectIdentifier("property name",n),ut(n);var r=kt(t).Properties;if(null!=r)for(var o=0,i=r.length;o<i;o++)if(r[o].Identifier===n)return o;return-1}function zt(e,t){var n=Object.create(null);function r(e){switch(n[e.Master]=!0,e.Category){case"Applet":e.CardList.forEach((function(e){return r(e)}))(e).OverlayList.forEach((function(e){return r(e)}));break;case"Card":case"Overlay":case"Compound":e.ComponentList.forEach((function(e){return r(e)}))}}e.forEach((function(e){return r(e)})),t&&(delete n.plainApplet,delete n.plainCard,delete n.plainOverlay,delete n.plainControl,delete n.plainCompound);var o=[];for(var i in n)o.push(i);return o}function Ut(e,t){return an(e).globalVisualSet[t]}function Ht(e,t){var n=an(e).globalVisualSet,r=t.Name;r in n&&d('VisualExists: a visual with the global name "'+r+'" exists already'),n[r]=t}function qt(e,t){var n=t.Name;delete an(e).globalVisualSet[n]}function $t(e){var t,n,r,o,i,a,l,s,u,c,f,h;function v(){s=!1,c=Object.create(null),f=Object.create(null),h=[]}function m(t){if(r.length>0&&function(e,t){for(var n=0,r=e.length;n<r;n++)x(e[n],t)}(r,t),"#"===t[0]){var o=Ut(e,t);null!=o&&(n[t]=o.Value)}return n[t]}function g(t,r,o,a){void 0===o&&(o=!1);var d=Rn(n[t],r);if(!d||o){if(t in c){if(d)return;throw new Error('CircularDependency: trigger variable "'+t+'" has been changed during an ongoing recalculation')}if(n[t]=r,c[t]=r,"#"===t[0]&&!a){var p=Ut(e,t);null!=p&&(p.Value=r)}if(function(e){var t=l[e];if(null==t)return;var n=!1;for(var r in t)r in f||(n=!0,f[r]=t[r]);if(!n)return;for(var r in h=[],f)h.push(r);h.sort((function(e,t){var n=i.get(f[e])||0,r=i.get(f[t])||0;switch(!0){case n<r:return-1;case n===r:return 0;default:return 1}}))}(t),!s&&(function(){s=!0,u=void 0;for(;h.length>0;){var e=h.shift(),t=f[e];delete f[e];try{C(t)}catch(e){console.error("error during automatic recalculation of reactive functions",e),u=e}}v()}(),null!=u))throw u}}function b(e,n,r,l){void 0===r&&(r=""),void 0===l&&(l=!1);var s=t.get(n);if(null==s){s="BRE-"+(Jt+=1),t.set(n,s);var u=an(e).reactiveFunctionList;if(null==u?an(e).reactiveFunctionList=[n]:u.push(n),o.set(n,Object.create(null)),i.set(n,0),""!==(r=r.trim().replace(/\s+/g," "))){for(var c=r.split(" "),f=0,d=c.length;f<d;f++)x(n,c[f]);if(!l){var p=o.get(n),h=[];for(var v in p)h.push(v);return void a.set(n,h)}}}C(n)}function y(e,n){var r=t.get(n);if(null!=r){var i=an(e).reactiveFunctionList;if(null!=i){var a=i.indexOf(n);a>=0&&i.splice(a,1)}var s=o.get(n);for(var u in s){var c=l[u];delete c[r],zn(c)&&delete l[u]}}}function x(e,n){var r=o.get(e);if(null==r&&d("InternalError: unregistered function"),!(n in r)){r[n]=!0,i.set(e,(i.get(e)||0)+1);var a=l[n];null==a&&(a=l[n]=Object.create(null));var s=t.get(e);null==s&&d("InternalError: unregistered function"),a[s]=e}}function C(e){var t=void 0,o=a.get(e);if(null!=o){t=Object.create(null);for(var i=0,l=o.length;i<l;i++){var s=o[i];t[s]=n[s]}}r.unshift(e);try{e(t),r.shift()}catch(e){throw r.shift(),e}}return t=new WeakMap,n=Object.create(null),r=[],o=new WeakMap,i=new WeakMap,a=new WeakMap,l=Object.create(null),v(),{$:function(e,t,n,r){switch(arguments.length-1){case 0:d("MissingArgument: reactive variable name or function expected");case 1:if(w(t))return m(t);if(M(t))return b(e,t);break;case 2:if(w(t))return g(t,n,!1);if(M(t)){if(p(n))return 1==n?b(e,t):y(e,t);if(w(n))return b(e,t,n,!1)}break;case 3:if(w(t)&&p(r))return g(t,n,r);if(M(t)&&w(n)&&p(r))return b(e,t,n,r)}d("InvalidArguments: variable name (with opt. value) or function (with opt. variable names) expected")},setReactiveVariable:g,clearReactiveVariable:function(e){delete n[e]},unregisterReactiveFunctionsOfVisual:function(e){var t=an(e).reactiveFunctionList;if(null!=t)for(var n=0,r=t.length;n<r;n++)y(e,t[0])}}}"Applet Card Overlay Compound Control".split(" ").forEach((function(e){return It["plain"+e]=!0})),e.registerMasterFromSerialization=function(e){Ye("serialization",e),St(yt(JSON.parse(e)))},e.unregisterMaster=Tt,e.hasMaster=function(t){return e.expectName("master name",t),null!=gt[t]},e.lacksMaster=function(t){return e.expectName("master name",t),null==gt[t]},e.createMaster=function(t,n,r,o){e.expectName("master name",t),Cn("master category",n,e.WAT_Categories),e.allowSemVer("master version",r),Qe("master template",o),t in gt&&d("MasterExists: a master with the name "+Vn(t)+" exists already"),St({Name:t,Category:n,Version:Ae(Ie(r||"0.0.1")),Template:o||'<div class="WAT '+t+'"></div>',UsageCount:0})},e.DuplicateOfMaster=function(t,n,r){e.expectName("new master name",n),e.allowSemVer("new master version",r),n in gt&&d("MasterExists: a master with the name "+Vn(n)+" exists already");var o=kt(t),i=Object.assign({},o);return i.Name=n,null!=r&&(i.Version=r),null!=o.Properties&&(i.Properties=[],o.Properties.forEach((function(e){return i.Properties.push(Object.assign({},e))}))),St(i),i},e.renameMaster=Wt,e.NameOfMaster=function(e){return kt(e),e},e.setNameOfMaster=function(e,t){Wt(e,t,!0)},e.CategoryOfMaster=function(e){return kt(e).Category},e.VersionOfMaster=function(e){var t,n=kt(e);return(t=n.Version).major+"."+(t.minor||"0")+"."+(t.Patch||"0")+(null==t.Build?"":"."+t.Build.toString(16))},e.setVersionOfMaster=function(e,t){var n,r,o=kt(e),i=Ae(Ie(t));n=o.Version,r=i,(n.major>r.major||n.major===r.major&&((n.minor||0)>(r.minor||0)||(n.minor||0)===(r.minor||0)&&((n.Patch||0)>(r.Patch||0)||(n.Patch||0)===(r.Patch||0)&&(n.Build||1)>(r.Build||1))))&&d("InvalidArgument: the new version of a master must be greater than the existing one"),o.Version=i,o.Version.Build=Te()},e.ResourcesOfMaster=function(e){return kt(e).Resources},e.pendingResourcesOfMaster=function(e){return kt(e).pendingResources},e.setPendingResourcesOfMaster=function(e,t){Qe("new master resources",t);var n=kt(e);null==t||""===t.trim()?delete n.pendingResources:n.pendingResources=t},e.activatePendingResourcesOfMaster=function(e){var t=kt(e);Tt(e),t.Resources=t.pendingResources,delete t.pendingResources,t.Version.Build=Te(),St(t)},e.TemplateOfMaster=function(e){return kt(e).Template},e.pendingTemplateOfMaster=function(e){return kt(e).pendingTemplate},e.setPendingTemplateOfMaster=function(e,t){Qe("new master template",t);var n=kt(e);null==t||""===t.trim()?delete n.pendingTemplate:n.pendingTemplate=t},e.activatePendingTemplateOfMaster=function(e){var t=kt(e);null==t.pendingTemplate?t.Template='<div class="WAT '+e+'"></div>':(t.Template=t.pendingTemplate,delete t.pendingTemplate),t.Version.Build=Te()},e.ClassesOfMaster=function(e){return Lt(kt(e).Classes)},e.pendingClassesOfMaster=function(e){return Lt(kt(e).pendingClasses)},e.setPendingClassesOfMaster=function(e,t){Qe("new master classes",t);var n=kt(e);null==t||""===t.trim()?delete n.pendingClasses:n.pendingClasses=wt(t)},e.activatePendingClassesOfMaster=function(e){var t=kt(e);t.Classes=t.pendingClasses,delete t.pendingClasses,t.Version.Build=Te(),Nt(e)},e.StylesOfMaster=function(e){return Bt(kt(e).Styles)},e.pendingStylesOfMaster=function(e){return Bt(kt(e).pendingStyles)},e.setPendingStylesOfMaster=function(e,t){Qe("new master styles",t);var n=kt(e);null==t||""===t.trim()?delete n.pendingStyles:n.pendingStyles=Ct(t)},e.activatePendingStylesOfMaster=function(e){var t=kt(e);t.Styles=t.pendingStyles,delete t.pendingStyles,t.Version.Build=Te(),Nt(e)},e.ScriptOfMaster=function(e){return kt(e).Script},e.pendingScriptOfMaster=function(e){return kt(e).pendingScript},e.setPendingScriptOfMaster=function(e,t){Qe("new master script",t);var n=kt(e);null==t||""===t.trim()?delete n.pendingScript:n.pendingScript=t},e.activatePendingScriptOfMaster=function(e){var t=kt(e);t.ErrorInfo=void 0,Et(t.pendingScript,t),null==t.ErrorInfo?(t.Script=t.pendingScript,delete t.pendingScript,t.Version.Build=Te(),Nt(e)):(t.ErrorInfo=void 0,Et(t.Script,t),null!=t.ErrorInfo&&Nt(e))},e.PropertiesOfMaster=function(e){var t=[],n=kt(e).Properties;if(null!=n)for(var r=0,o=n.length;r<o;r++)t.push(Object.assign({},n[r]));return t},e.PropertyNamesOfMaster=function(e){var t=[],n=kt(e).Properties;if(null!=n)for(var r=0,o=n.length;r<o;r++)t.push(n[r].Identifier);return t},e.PropertyOfMaster=function(t,n){e.allowIdentifier("property name",n),ut(n);var r=kt(t).Properties;if(null!=r)for(var o=0,i=r.length;o<i;o++){var a=r[o];if(a.Identifier===n)return Object.assign({},a)}},e.MasterHasProperty=Vt,e.MasterLacksProperty=function(e,t){return!Vt(e,t)},e.insertPropertyOfMasterAt=function(e,t,n){je("insertion index",n);var r=rt("property specification",t),o=r.Identifier;Rt(e,o)>=0&&d("PropertyExists: a property with the name "+Vn(o)+" exists already");var i=gt[e],a=i.Properties;null==a?i.Properties=[r]:(n=null==n?a.length:Math.min(n,a.length),a.splice(n,0,r))},e.renamePropertyOfMaster=Ft,e.changePropertyOfMaster=function(t,n,r){e.expectIdentifier("property identifier",n),ut(n);var o=rt("property specification",r);n!==o.Identifier&&Ft(t,n,o.Identifier);var i=Rt(t,n);gt[t].Properties[i]=o},e.IndexOfPropertyOfMaster=Rt,e.PropertyCountOfMaster=function(e){var t=kt(e).Properties;return null==t?0:t.length},e.PropertyOfMasterMayBeMovedUp=function(e,t){return Rt(e,t)>0},e.PropertyOfMasterMayBeMovedDown=function(e,t){var n=Rt(e,t);return n>=0&&n<gt[e].Properties.length-1},e.movePropertyOfMasterToTop=function(e,t){var n=Rt(e,t);if(n>0){var r=gt[e].Properties,o=r.splice(n,1)[0];r.unshift(o)}},e.movePropertyOfMasterUp=function(e,t){var n=Rt(e,t);if(n>0){var r=gt[e].Properties,o=r.splice(n,1)[0];r.splice(n-1,0,o)}},e.movePropertyOfMasterDown=function(e,t){var n=gt[e].Properties,r=Rt(e,t);if(r<n.length-1){var o=n.splice(r,1)[0];n.splice(r+1,0,o)}},e.movePropertyOfMasterToBottom=function(e,t){var n=gt[e].Properties,r=Rt(e,t);if(r<n.length-1){var o=n.splice(r,1)[0];n.push(o)}},e.movePropertyOfMasterTo=function(e,t,n){ke("property index",n);var r=Rt(e,t);if(r<0&&d("NoSuchProperty: a property with the name "+Vn(t)+" does not exist"),r!==n){var o=gt[e].Properties,i=o.splice(r,1)[0];o.splice(n,0,i)}},e.removePropertyOfMaster=function(e,t){var n=Rt(e,t);if(n>=0){var r=gt[e].Properties;r.splice(n,1),0===r.length&&delete gt[e].Properties}},e.ErrorInfoOfMaster=function(e){return kt(e).ErrorInfo},e.UsageCountOfMaster=function(e){return kt(e).UsageCount},e.Masters=function(){var e=[];for(var t in gt)e.push(t);return e},e.instantiableMasters=function(){var e=[];for(var t in gt){"Applet"!==gt[t].Category&&e.push(t)}return e},e.instantiableLayerMasters=function(){var e=[];for(var t in gt){var n=gt[t];"Card"!==n.Category&&"Overlay"!==n.Category||e.push(t)}return e},e.instantiableComponentMasters=function(){var e=[];for(var t in gt){var n=gt[t];"Control"!==n.Category&&"Compound"!==n.Category||e.push(t)}return e},e.missingMasters=function(){var e=Object.create(null);ee(document.body.querySelectorAll(".WAT[data-wat-master]"),(function(t){var n=fe(t,"wat-master");k(n)&&!(n in gt)&&(e[n]=n)}));var t=[];for(var n in e)t.push(n);return t},e.unusedMasters=function(){var e=[];for(var t in gt){gt[t].UsageCount<=0&&e.push(t)}return e},e.MastersUsedByVisuals=zt;var Jt=0;function Gt(e){if(null!=jn){var t=e.target.closest(".WAT.Applet");if(null!=t){var n=nn(t);null!=n&&jn.layoutsApplet(n)&&(e.stopPropagation(),e.preventDefault())}}}function Zt(t){for(var n,r,o,i,a=[],l=1;l<arguments.length;l++)a[l-1]=arguments[l];if(w(a[0])&&a[0].startsWith("@")){var s=a.shift().slice(1),u=void 0;"."===s[0]?(e.expectName("tap point master name",s.slice(1)),u=ne(t.Peer,".WAT"+s)):(e.expectUniversalName("tap point name",s),u=oe(t.Peer,".WAT",(function(e){return nn(e).Name===s}))),null!=u&&(n=nn(u))}else n=t;if(r=e.expectedName("event name",a.shift()),o=w(a[0])?a.shift():void 0,i=st("event handler",a.shift()),null!=n){var c=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var a=e[0];if(null!=jn&&jn.layoutsApplet(t.Applet))return a.stopPropagation(),void a.preventDefault();n===t&&null==o&&a.target!==t.Peer||i.apply(t,e)},f=on.get(t),d=f.EventHandlers;null==d&&(f.EventHandlers=d=[]);for(var p=0,h=d.length;p<h;p++){var v=d[p];if(v.TapPoint===n&&v.EventSelector===o&&v.EventName===r&&v.EventHandler===i)return}d.push({TapPoint:n,EventName:r,EventSelector:o,EventHandler:i,actualHandler:c}),null==o?n.Peer.on(r,c):n.Peer.on(r,o,c)}}function Kt(t){for(var n,r,o,i,a=[],l=1;l<arguments.length;l++)a[l-1]=arguments[l];if(w(a[0])&&a[0].startsWith("@")){var s=a.shift().slice(1),u=void 0;"."===s[0]?(e.expectName("tap point master name",s.slice(1)),u=ne(t.Peer,".WAT"+s)):(e.expectUniversalName("tap point name",s),u=oe(t.Peer,".WAT",(function(e){return nn(e).Name===s}))),null!=u&&(n=nn(u))}else n=t;if(r=e.allowedName("event name",a.shift()),o=w(a[0])?a.shift():null,i=at("event handler",a.shift()),null!=n){var c=on.get(t),f=c.EventHandlers;if(null!=f){for(var d=f.length-1;d>=0;d--){var p=f[d];if(!(p.TapPoint!==n||null!=r&&p.EventName!==r||p.EventSelector!==o||null!=i&&p.EventHandler!==i)){var h=p.actualHandler;null==p.EventSelector?n.Peer.off(p.EventName,h):n.Peer.off(p.EventName,p.EventSelector,h),f.splice(d,1)}}0===f.length&&delete c.EventHandlers}}}function Qt(t){for(var n,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];if(w(r[0])&&r[0].startsWith("@")){var i=r.shift().slice(1),a=void 0;"."===i[0]?(e.expectName("injection point master name",i.slice(1)),a=ne(t.Peer,".WAT"+i)):(e.expectUniversalName("injection point name",i),a=oe(t.Peer,".WAT",(function(e){return nn(e).Name===i}))),null!=a&&(n=nn(a))}else n=t;if(null!=n){var l=r.shift();n.Peer.trigger(l,r)}}function Xt(e){return an(e).ErrorInfo}function Yt(e,t){var n=an(e);null==t?(delete n.ErrorInfo,ve(te(n.Peer.children,".WAT-ErrorIndicator"))):null==n.ErrorInfo&&(n.ErrorInfo=t,ve(te(n.Peer.children,".WAT-ErrorIndicator")),n.Peer.appendChild(me('<button class="WAT-ErrorIndicator"></button>')))}pe(document.body,"value-changed",void 0,(function(e){var t,n=nn(e.target);if(null!=n){var r=n.Name;"#"===(r||"")[0]&&(null===(t=an(n.Applet).ReactivityContext)||void 0===t||t.setReactiveVariable(r,e.detail,!1,"wasControlValueChange"))}})),document.body.addEventListener("mousedown",Gt),document.body.addEventListener("mousemove",Gt),document.body.addEventListener("mouseup",Gt),document.body.addEventListener("mouseenter",Gt),document.body.addEventListener("mouseleave",Gt),document.body.addEventListener("keydown",Gt),document.body.addEventListener("keypress",Gt),document.body.addEventListener("keyup",Gt),document.body.addEventListener("input",Gt),document.body.addEventListener("change",Gt),document.body.addEventListener("click",Gt);var en=Object.create(null),tn=new WeakMap;function nn(e){return null==e?void 0:tn.get(e)}function rn(t){e.expectElement("element",t);var n=tn.get(t);return null!=n?n:null==(n=t.closest(".WAT"))?void 0:tn.get(n)}e.VisualForElement=rn;var on=new WeakMap;function an(e){return on.get(e)}function ln(e){return on.get(e).Peer}function sn(e){var t=e.closest(".WAT.Applet");return null==t?void 0:nn(t)}function un(e,t){var n=fe(e,"wat-master");return k(n)?n:null==t?"plainVisual":"plain"+t}function cn(e,t){var n=function(e,t){switch(!0){case e.classList.contains("Applet"):return"Applet";case e.classList.contains("Card"):return"Card";case e.classList.contains("Overlay"):return"Overlay";case e.classList.contains("Control"):return"Control";case e.classList.contains("Compound"):return"Compound";default:switch(t){case"Applet":return"Applet";case"Layer":case"Card":return"Card";case"Overlay":return"Overlay";case"Component":return te(e.children,".WAT.Control,.WAT.Compound").length>0?"Compound":"Control";case"Control":return"Control";case"Compound":return"Compound";default:d("BrokenVisual: cannot determine category of given visual")}}}(e,t);if(function(e,t){switch(t){case"Applet":return"Applet"!==e;case"Layer":return"Card"!==e&&"Overlay"!==e;case"Card":return"Card"!==e;case"Overlay":return"Overlay"!==e;case"Component":return"Control"!==e&&"Compound"!==e;case"Control":return"Control"!==e;case"Compound":return"Compound"!==e;default:d("InternalError: unforeseen visual category")}}(n,t)){var r=n;switch(t){case"Layer":n="Card";break;case"Component":n=te(e.children,".WAT.Control,.WAT.Compound").length>0?"Compound":"Control";default:n=t}var o=pn(n,e),i=sn(e);return null!=i&&(Yt(o,{Title:"Inappropriate Category",longMessage:"This visual belongs to category "+Vn(r)+", which is not allowed here",shortMessage:"inappropriate category "+Vn(r),Applet:i,Sufferer:o,Property:"Category"}),a()),o}function a(){switch(n){case"Applet":te(e.children,".WAT.Card,.WAT.Overlay").forEach((function(e){fn(e,"Layer")}));break;case"Card":case"Overlay":case"Compound":te(e.children,".WAT.Control,.WAT.Compound").forEach((function(e){fn(e,"Component")}))}}var l=pn(n,e),s=sn(e);if(null!=s){var u=un(e,n),c=gt[u];if(null==c)return Yt(l,{Title:"No such Master",longMessage:"A visual master called "+Vn(u)+" is not available",shortMessage:"unknown master "+Vn(u),Applet:s,Sufferer:l,Property:"Master"}),a(),l;var f=c.Classes;if(null!=f&&f.forEach((function(t){e.classList.add(t)})),c.Category!==n)return Yt(l,{Title:"Inappropriate Master",longMessage:"Master "+Vn(u)+" is not foreseen for category "+Vn(n),shortMessage:"inappropriate master "+Vn(u),Applet:s,Sufferer:l,Property:"Master"}),a(),l;var p=function(e){var t=fe(e,"wat-master-version");return U(t)?Ie(t):void 0}(e);if(null!=p&&!function(e,t){if(null==e.major)return!0;if(e.major!==t.major)return!1;if(null==e.minor)return!0;if(0===t.major){if(e.minor!==t.minor)return!1}else if(e.minor>t.minor)return!1;return null==e.Patch||e.Patch<=t.Patch}(p,c.Version))return Yt(l,{Title:"Inappropriate Version",longMessage:"This visual requires a different version of master "+Vn(u)+" than available",shortMessage:"inappropriate master "+Vn(u),Applet:s,Sufferer:l,Property:"Version"}),a(),l;if(null!=c.ErrorInfo)return Yt(l,c.ErrorInfo),a(),l;"Applet"===n&&0===te(e.children,".WAT.Card").length&&e.insertBefore(me('<div class="WAT Card" data-wat-master="plainCard" style="visibility:visible"></div>'),e.firstChild);var h=function(e){var t=fe(e,"wat-name");return L(t)?t:void 0}(e);if(null!=h&&"#"===h[0])try{Ht(s,l)}catch(e){return Yt(l,{Title:"Global name Collision",longMessage:"The global name of this visual "+Vn(h)+" has already been used",shortMessage:"global name collision "+Vn(h),Applet:s,Sufferer:l,Property:"Name"}),a(),l}var v=function(e){var t=fe(e,"wat-state");if(null==t)return null;try{return JSON.parse(t)}catch(e){return null}}(e);null!=v&&(an(l).State=v);var m=function(e){var t=fe(e,"wat-script");return S(t)?t:void 0}(e);if(null!=c.compiledScript||null!=m){var g=ct.bind(null,l),b=ft.bind(null,l),y=Zt.bind(null,l),x=Kt.bind(null,l),w=Qt.bind(null,l),C=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.unshift(l),null===(e=an(s).ReactivityContext)||void 0===e?void 0:e.$.apply(null,t)};if(null!=c.compiledScript)try{c.compiledScript.call(l,g,b,y,x,w,C)}catch(e){return Yt(l,{Title:"Execution Error in Master Script",longMessage:"The script of master "+Vn(u)+" could not be applied to this visual",shortMessage:e.message,Reason:e,Applet:s,Sufferer:l,Property:"Master"}),a(),l}var O=void 0;if(null!=m){try{O=new Function("toGet","toSet","on","off","trigger","$",m)}catch(e){return Yt(l,{Title:"Compilation Error",longMessage:"The script of this visual could not be compiled",shortMessage:e.message,Reason:e,Applet:s,Sufferer:l,Property:"Script"}),a(),l}try{O.call(l,g,b,y,x,w,C)}catch(e){return Yt(l,{Title:"Execution Error in Visual Script",longMessage:"The script of this visual failed",shortMessage:e.message,Reason:e,Applet:s,Sufferer:l,Property:"Script"}),a(),l}}}a()}return l}function fn(e,t){cn(e,t)}var dn=0;function pn(e,t){var n,r,o=tn.get(t);if(null==o){var i=le(t,"data-wat-unique-id");if(null!=i){var a=parseInt(i,10);y(a)&&a<dn&&null==en[a]&&(n=a),le(t,"data-wat-unique-id",void 0)}}else n=on.get(o).uniqueId;switch(null==n&&(n=hn()),e){case"Applet":r=new wn;break;case"Card":r=new Tn;break;case"Overlay":r=new Mn;break;case"Control":r=new Nn;break;case"Compound":r=new En;break;default:d("InternalError: unforeseen visual category")}if(tn.set(t,r),en[n]=r,t.classList.add("WAT",e),on.set(r,{uniqueId:n,Peer:t}),"Applet"===e){var l=on.get(r);l.globalVisualSet=Object.create(null),l.ReactivityContext=$t(r)}return r}function hn(){return++dn}function vn(e,t,n){var r=gt[e.Master];if(null!=(null==r?void 0:r.Styles)&&t in r.Styles){var o=r.Styles[t];if("initial"===o)return;n=o}se(ln(e),t,n)}function mn(e,t){var n=void 0,r=gt[e.Master];if(null==(null==r?void 0:r.Styles))for(var o in t)t.hasOwnProperty(o)&&null!==t[o]&&(null==n&&(n={}),n[o]=t[o]);else{var i=r.Styles;for(var o in t)t.hasOwnProperty(o)&&!(o in i)&&(null==n&&(n={}),n[o]=t[o])}if(null!=n)for(var o in n)n.hasOwnProperty(o)&&se(ln(e),o,n[o])}function gn(e,t){var n=e.Peer;null!=t&&(un(n),n.data("wat-master",t)),e.trigger("prepare-refresh"),bn(e),fn(n,e.Category)}function bn(e,t){var n;!function(e){var t=on.get(e),n=t.EventHandlers;if(null!=n){for(var r=0,o=n.length;r<o;r++){var i=n[r],a=i[0],l=i[1],s=i[2],u=i[3];null==s?a.Peer.off(l,u):a.Peer.off(l,s,u)}delete t.EventHandlers}}(e);var r=e.uniqueId;y(r)&&delete en[r];var o=e.Name;null!=o&&"#"===o[0]&&qt(e.Applet,e),null===(n=an(e.Applet).ReactivityContext)||void 0===n||n.unregisterReactiveFunctionsOfVisual(e),t&&te(e.Peer.children,".WAT.Card,.WAT.Overlay,.WAT.Compound,.WAT.Control").forEach((function(e){bn(nn(e),t)}))}e.newUniqueId=hn;var yn=function(){function t(){}return Object.defineProperty(t.prototype,"uniqueId",{get:function(){return an(this).uniqueId},set:function(e){ke("new unique id",e);var t=an(this).uniqueId;switch(!0){case e===t:return;case e>dn:d("InvalidArgument: forbidden id value given");case null!=en[e]:d("InvalidArgument: the given id is not unique")}delete en[t],en[e]=this,an(this).uniqueId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Peer",{get:function(){return an(this).Peer},set:function(e){q("Peer")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAttached",{get:function(){return document.body.contains(an(this).Peer)},set:function(e){q("isAttached")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Id",{get:function(){var e=le(ln(this),"id");return j(e)?e:void 0},set:function(t){e.allowId("id",t);var n=ln(this);t!=le(n,"id")&&(null==t?le(n,"id",void 0):null==document.getElementById(t)?le(n,"id",t):d("InvalidArgument: the given HTML id is not unique"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){var e=fe(ln(this),"wat-name");return L(e)?e:void 0},set:function(t){var n,r,o,i;e.allowUniversalName("name",t);var a=ln(this),l=fe(a,"wat-name");if(t!=l){var s=this.Applet;l.startsWith("#")&&(qt(s,l),null===(r=null===(n=an(this.Applet))||void 0===n?void 0:n.ReactivityContext)||void 0===r||r.clearReactiveVariable(l)),fe(a,"wat-name",t||void 0),t.startsWith("#")&&(Ht(s,this),null===(i=null===(o=an(this.Applet))||void 0===o?void 0:o.ReactivityContext)||void 0===i||i.setReactiveVariable(t,this.Value))}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Label",{get:function(){var e=fe(ln(this),"wat-label");return B(e)?e:void 0},set:function(t){e.allowLabel("label",t),fe(ln(this),"wat-label",t||void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Category",{get:function(){var e=ln(this);switch(!0){case e.classList.contains("Applet"):return"Applet";case e.classList.contains("Card"):return"Card";case e.classList.contains("Overlay"):return"Overlay";case e.classList.contains("Control"):return"Control";case e.classList.contains("Compound"):return"Compound";default:d("BrokenVisual: cannot determine category of given visual")}},set:function(e){q("Category")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Master",{get:function(){var e=fe(ln(this),"wat-master");if(k(e))return e;d("InvalidVisual: the given visual does not have a master")},set:function(t){if(e.allowName("master",t),null==t)t="plain"+this.Category;else{var n=gt[t];null!=n&&n.Category!==this.Category&&d("InvalidArgument: the given master is not made for visuals of type "+Vn(this.Category))}var r=ln(this);t!=fe(r,"wat-master")&&(fe(r,"wat-master",t),gn(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ErrorInfo",{get:function(){return Xt(this)},set:function(e){q("ErrorInfo")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Container",{get:function(){var e=ne(ln(this),".WAT.Card,.WAT.Overlay,.WAT.Compound");return null==e?void 0:nn(e)},set:function(e){q("Container")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Layer",{get:function(){var e=ln(this).closest(".WAT.Card,.WAT.Overlay");return null==e?void 0:nn(e)},set:function(e){q("Layer")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Applet",{get:function(){var e=ln(this).closest(".WAT.Applet");return null==e?void 0:nn(e)},set:function(e){q("Applet")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mayBeDesigned",{get:function(){return"false"!==this.Peer.data("wat-designability")},set:function(e){ie("designability",e),this.Peer.data("wat-designability",!1===e?"false":null)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mayBeDeleted",{get:function(){return"false"!==this.Peer.data("wat-deletability")},set:function(e){ie("deletability",e),this.Peer.data("wat-deletability",!1===e?"false":null)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return"hidden"!==se(this.Peer,"visibility")},set:function(e){ie("visibility",e),vn(this,"visibility",!0===e?"visible":"hidden")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isShown",{get:function(){var e=this.Peer;if(!document.body.contains(e))return!1;for(;e!==document.body;){if("none"===se(e,"display")||"hidden"===se(e,"visibility"))return!1;e=e.parentElement}return!0},set:function(e){q("isShown")},enumerable:!1,configurable:!0}),t.prototype.show=function(){this.isVisible=!0},t.prototype.hide=function(){this.isVisible=!1},Object.defineProperty(t.prototype,"isEnabled",{get:function(){return!this.Peer.disabled},set:function(e){ie("enabling",e),this.Peer.disabled=!e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDisabled",{get:function(){return this.Peer.disabled},set:function(e){ie("disabling",e),this.Peer.disabled=e},enumerable:!1,configurable:!0}),t.prototype.enable=function(){this.isEnabled=!1},t.prototype.disable=function(){this.isEnabled=!0},Object.defineProperty(t.prototype,"PropertySet",{get:function(){var e=Object.create(null),t=gt[this.Master];if(null==t)return e;var n=t.Properties;if(null==n)return e;for(var r=0,o=n.length;r<o;r++){var i=n[r];e[i.Identifier]=Object.assign(Object.create(null),i),null!=i.ValueList&&(e[i.Identifier].ValueList=i.ValueList.slice())}return e},set:function(e){q("PropertySet")},enumerable:!1,configurable:!0}),t.prototype.PropertyMayBeDesigned=function(t){e.expectIdentifier("property name",t);var n=gt[this.Master];return null==(null==n?void 0:n.undesignablePropertySet)||!(t in n.undesignablePropertySet)},Object.defineProperty(t.prototype,"State",{get:function(){return an(this).State},set:function(e){null==e?delete an(this).State:an(this).State=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Value",{get:function(){var e=an(this).State;return null==e?void 0:e.Value},set:function(e){var t=an(this).State;null==e?null!=t&&delete t.Value:(null==t&&(t=an(this).State={}),t.Value=e),this.trigger("value-changed",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Script",{get:function(){return this.Peer.data("wat-script")},set:function(e){q("Script")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pendingScript",{get:function(){return this.Peer.data("wat-pending-script")},set:function(e){Qe("script",e),this.Peer.data("wat-pending-script",""===(e||"").trim()?null:e)},enumerable:!1,configurable:!0}),t.prototype.activatePendingScript=function(){this.clearPendingScriptError();var e=an(this),t=this.pendingScript;if(null==t)""!==(this.Script||"").trim()&&(this.Peer.data("wat-script",null),gn(this));else{var n=void 0;try{new Function("toGet","toSet","on","off","trigger","$",t)}catch(t){n={Title:"Compilation Error",longMessage:"pending visual script could not be compiled",shortMessage:t.message,Reason:t,Applet:this.Applet,Sufferer:this,Property:"pendingScript"},e.pendingScriptError=n}null==n&&(this.Peer.data("wat-script",t),this.Peer.data("wat-pending-script",null),gn(this))}},Object.defineProperty(t.prototype,"pendingScriptError",{get:function(){return an(this).pendingScriptError},set:function(e){q("pendingScriptError")},enumerable:!1,configurable:!0}),t.prototype.clearPendingScriptError=function(){delete an(this).pendingScriptError},Object.defineProperty(t.prototype,"Classes",{get:function(){return this.Peer.classList.slice().sort().join(" ")},set:function(e){Fe("class list",e);for(var t=e.trim().replace(/\s+/g," ").split(" "),n=0,r=t.length;n<r;n++){k(u=t[n])||d("InvalidArgument: invalid class name "+Vn(u)+" given")}var o,i,a=(o=t,i=Object.create(null),o.forEach((function(e){return i[e]=e})),i);a.WAT=!0,a[this.Category]=!0;var l=gt[this.Master];null!=(null==l?void 0:l.Classes)&&l.Classes.forEach((function(e){return a[e]=!0}));var s=[];for(var u in a)s.push(u);this.Peer.className=s.join(" ")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TabIndex",{get:function(){var e=le(this.Peer,"tabindex");return null==e?void 0:parseInt(e,10)},set:function(e){Pe("tab index",e,-1,32767),le(this.Peer,"tabindex",e+"")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"PointerSensitivity",{get:function(){return"none"!==se(this.Peer,"pointer-events")},set:function(e){ie("pointer sensitivity",e),vn(this,"pointer-events",!0===e?"auto":"none")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Overflows",{get:function(){function e(e){switch(e){case"visible":case"hidden":case"scroll":case"auto":return e;case"clip":return"hidden";case"overlay":default:return"auto"}}var t=se(this.Peer,"overflow").split(" "),n=e(t[0]);return[n,e(t[1]||n)]},set:function(t){_t("list of overflow settings",t),null!=t&&(Cn("horizontal overflow",t[0],e.WAT_Overflows),Cn("vertical overflow",t[1],e.WAT_Overflows)),vn(this,"overflow",null==t?null:t.join(" "))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TextOverflow",{get:function(){return"clip"===se(this.Peer,"text-overflow")?"clip":"ellipsis"},set:function(t){xn("text overflow",t,e.WAT_TextOverflows),vn(this,"text-overflow",t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Opacity",{get:function(){return Math.round(100*parseFloat(se(this.Peer,"opacity")))},set:function(e){ye("opacity",e,0,1),vn(this,"opacity",Math.round(e)+"%")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return pt(this).x},set:function(t){e.expectLocation("x coordinate",t),ht(this,t,void 0,void 0,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return pt(this).y},set:function(t){e.expectLocation("y coordinate",t),ht(this,void 0,t,void 0,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Width",{get:function(){return pt(this).Width},set:function(t){e.expectDimension("width",t),ht(this,void 0,void 0,t,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Height",{get:function(){return pt(this).Height},set:function(t){e.expectDimension("height",t),ht(this,void 0,void 0,void 0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Position",{get:function(){var e=pt(this);return{x:e.x,y:e.y}},set:function(t){jt("position",t),e.expectLocation("x coordinate",t.x),e.expectLocation("y coordinate",t.y),ht(this,t.x,t.y,void 0,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Size",{get:function(){var e=pt(this);return{Width:e.Width,Height:e.Height}},set:function(t){jt("size",t),e.expectDimension("width",t.Width),e.expectDimension("height",t.Height),ht(this,void 0,void 0,t.Width,t.Height)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Geometry",{get:function(){return pt(this)},set:function(t){Pt("visual geometry",t),e.expectLocation("x coordinate",t.x),e.expectLocation("y coordinate",t.y),e.expectDimension("width",t.Width),e.expectDimension("height",t.Height),ht(this,t.x,t.y,t.Width,t.Height)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"GeometryOnDisplay",{get:function(){return{x:(e=ln(this).getBoundingClientRect()).left,Width:e.width,y:e.top,Height:e.height};var e},set:function(e){q("GeometryOnDisplay")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAnchoring",{get:function(){return vt(this)},set:function(t){Cn("horizontal anchoring",t,e.WAT_horizontalAnchorings),function(e,t){if(vt(e)!==t){var n,r=ln(e),o=Math.round(r.offsetLeft),i=Math.round(r.offsetWidth),a=Math.round(dt(r).offsetWidth-o-i);switch(t){case"left-width":n={left:o+"px",width:i+"px",right:"auto"};break;case"width-right":n={left:"auto",width:i+"px",right:a+"px"};break;case"left-right":n={left:o+"px",width:"auto",right:a+"px"};break;default:d("InternalError: unforeseen horizontal anchoring")}mn(e,n)}}(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalAnchoring",{get:function(){return mt(this)},set:function(t){Cn("vertical anchoring",t,e.WAT_verticalAnchorings),function(e,t){if(mt(e)!==t){var n,r=ln(e),o=Math.round(r.offsetTop),i=Math.round(r.offsetHeight),a=Math.round(dt(r).offsetHeight-o-i);switch(t){case"top-height":n={top:o+"px",height:i+"px",bottom:"auto"};break;case"height-bottom":n={top:"auto",height:i+"px",bottom:a+"px"};break;case"top-bottom":n={top:o+"px",height:"auto",bottom:a+"px"};break;default:d("InternalError: unforeseen vertical anchoring")}mn(e,n)}}(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalOffsets",{get:function(){return function(e){var t=ln(e),n=Math.round(t.offsetLeft),r=Math.round(t.offsetWidth);switch(vt(e)){case"left-width":return[n,r];case"width-right":return[r,Math.round(dt(t).offsetWidth-n-r)];case"left-right":return[n,Math.round(dt(t).offsetWidth-n-r)];default:return[n,r]}}(this)},set:function(t){switch(vt(this)){case"left-width":e.allowLocation('"left" offset',t[0]),e.allowDimension('"width" offset',t[1]);break;case"width-right":e.allowDimension('"width" offset',t[0]),e.allowLocation('"right" offset',t[1]);break;case"left-right":e.allowLocation('"left" offset',t[0]),e.allowLocation('"right" offset',t[1])}!function(e,t){switch(ln(e),vt(e)){case"left-width":null!=t[0]&&vn(e,"left",Math.round(t[0])+"px"),null!=t[1]&&vn(e,"width",Math.round(t[1])+"px");break;case"width-right":null!=t[0]&&vn(e,"width",Math.round(t[0])+"px"),null!=t[1]&&vn(e,"right",Math.round(t[1])+"px");break;case"left-right":null!=t[0]&&vn(e,"left",Math.round(t[0])+"px"),null!=t[1]&&vn(e,"right",Math.round(t[1])+"px")}}(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalOffsets",{get:function(){return function(e){var t=ln(e),n=Math.round(t.offsetTop),r=Math.round(t.offsetHeight);switch(mt(e)){case"top-height":return[n,r];case"height-bottom":return[r,Math.round(dt(t).offsetHeight-n-r)];case"top-bottom":return[n,Math.round(dt(t).offsetHeight-n-r)];default:return[n,r]}}(this)},set:function(t){switch(mt(this)){case"top-height":e.allowLocation('"top" offset',t[0]),e.allowDimension('"height" offset',t[1]);break;case"height-bottom":e.allowDimension('"height" offset',t[0]),e.allowLocation('"bottom" offset',t[1]);break;case"top-bottom":e.allowLocation('"top" offset',t[0]),e.allowLocation('"bottom" offset',t[1])}!function(e,t){switch(mt(e)){case"top-height":null!=t[0]&&vn(e,"top",Math.round(t[0])+"px"),null!=t[1]&&vn(e,"height",Math.round(t[1])+"px");break;case"height-bottom":null!=t[0]&&vn(e,"height",Math.round(t[0])+"px"),null!=t[1]&&vn(e,"bottom",Math.round(t[1])+"px");break;case"top-bottom":null!=t[0]&&vn(e,"top",Math.round(t[0])+"px"),null!=t[1]&&vn(e,"bottom",Math.round(t[1])+"px")}}(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minWidth",{get:function(){return parseFloat(se(this.Peer,"min-width"))},set:function(t){e.allowDimension("minimal width",t),vn(this,"min-width",Math.round(t)+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){var e=se(this.Peer,"max-width");return"none"===e?1/0:parseFloat(e)},set:function(t){e.allowDimension("maximal width",t),vn(this,"max-width",t===1/0?"none":Math.round(t)+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minHeight",{get:function(){return parseFloat(se(this.Peer,"min-height"))},set:function(t){e.allowDimension("minimal height",t),vn(this,"min-height",Math.round(t)+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxHeight",{get:function(){var e=se(this.Peer,"max-height");return"none"===e?1/0:parseFloat(e)},set:function(t){e.allowDimension("maximal height",t),vn(this,"max-height",t===1/0?"none":Math.round(t)+"px")},enumerable:!1,configurable:!0}),t.prototype.coversPointOnDisplay=function(t,n){e.expectLocation("x coordinate",t),e.expectLocation("y coordinate",n);var r=this.GeometryOnDisplay;return t>=r.x&&t<r.x+r.Width&&n>=r.y&&n<r.y+r.Height},Object.defineProperty(t.prototype,"FontFamily",{get:function(){return se(this.Peer,"font-family")},set:function(e){tt("font family",e),vn(this,"font-family",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FontSize",{get:function(){return parseFloat(se(this.Peer,"font-size"))},set:function(t){e.allowDimension("font size",t),vn(this,"font-size",null==t?null:Math.round(t)+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FontWeight",{get:function(){var t=se(this.Peer,"font-weight");switch(t){case"lighter":case"normal":case"bolder":case"bold":return t;default:var n=Math.max(1,Math.min(9,Math.round(parseFloat(t)/100)))-1;return e.WAT_FontWeights[n]}},set:function(t){switch(xn("font weight",t,e.WAT_FontWeights),t){case null:case void 0:vn(this,"font-weight",null);break;case"lighter":case"normal":case"bolder":case"bold":vn(this,"font-weight",t);break;default:vn(this,"font-weight",i[t])}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FontStyle",{get:function(){var e=se(this.Peer,"font-style");switch(e){case"normal":case"italic":return e;default:return e.startsWith("oblique")?"italic":"normal"}},set:function(t){xn("font weight",t,e.WAT_FontStyles),vn(this,"font-style",t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"LineHeight",{get:function(){var e=se(this.Peer,"line-height");switch(!0){case"normal"===e:return Math.round(1.5*this.FontSize);case e.indexOf("%")>0:return Math.round(100*this.FontSize*parseFloat(e));default:return parseFloat(e)}},set:function(t){e.allowDimension("line height",t),vn(this,"line-height",null==t?null:Math.round(t)+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TextDecoration",{get:function(){var t=window.getComputedStyle(this.Peer),n=t.textDecorationColor,r=t.textDecorationLine,o=t.textDecorationStyle,i=t.textDecorationThickness;if("none"!==r&&H(r,e.WAT_TextDecorationLines)){var a=parseFloat(i);return{Line:r,Color:qn(n||"#000000"),Style:H(o,e.WAT_TextDecorationStyles)?o:"solid",Thickness:isNaN(a)?1:Math.round(a)}}return{Line:"none"}},set:function(t){Mt("text decoration",t),null!=t&&(Cn("text decoration shape",t.Line,e.WAT_TextDecorationLines),In("text decoration color",t.Color),Cn("text decoration style",t.Style,e.WAT_TextDecorationStyles),e.allowDimension("text decoration thickness",t.Thickness)),null==t?mn(this,{"text-decoration-color":void 0,"text-decoration-line":void 0,"text-decoration-style":void 0,"text-decoration-thickness":void 0}):"none"===t.Line?vn(this,"text-decoration-line","none"):mn(this,{"text-decoration-color":null==t.Color?"currentColor":$n(qn(t.Color)),"text-decoration-line":t.Line,"text-decoration-style":t.Style,"text-decoration-thickness":null==t.Thickness?"from-font":Math.round(t.Thickness)+"px"})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TextShadow",{get:function(){var e=se(this.Peer,"text-shadow");return"none"===e?{xOffset:0,yOffset:0,BlurRadius:0,Color:"#00000000"}:(e=e.replace(/,.*$/,"").split(" "),{xOffset:parseFloat(e[0]),yOffset:parseFloat(e[1]),BlurRadius:parseFloat(e[2]),Color:qn(e[3])})},set:function(t){if(Mt("text shadow",t),null!=t&&(e.expectLocation("text shadow x offset",t.xOffset),e.expectLocation("text shadow y offset",t.yOffset),e.expectDimension("text shadow blur radius",t.BlurRadius),Sn("text shadow color",t.Color)),null==t)vn(this,"text-shadow",null);else{var n=qn(t.Color);vn(this,"text-shadow","#00000000"===n?"none":Math.round(t.xOffset)+"px "+Math.round(t.yOffset)+"px "+Math.round(t.BlurRadius)+"px "+$n(n))}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TextAlignment",{get:function(){return se(this.Peer,"text-align")},set:function(t){xn("text alignment",t,e.WAT_TextAlignments),vn(this,"text-align",t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ForegroundColor",{get:function(){return qn(se(this.Peer,"color"))},set:function(e){In("foreground color",e),vn(this,"color",null==e?null:qn(e))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Color",{get:function(){return this.ForegroundColor},set:function(e){this.ForegroundColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"BackgroundColor",{get:function(){return qn(se(this.Peer,"background-color"))},set:function(e){In("background color",e),vn(this,"background-color",null==e?null:qn(e))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"BackgroundTexture",{get:function(){var e=window.getComputedStyle(this.Peer),t=e.backgroundImage,n=e.backgroundPosition,r=e.backgroundSize,o=e.backgroundRepeat,i={ImageURL:"",Mode:"normal",xOffset:0,yOffset:0};"none"!==t&&(i.ImageURL=t.slice(5,t.length-2));var a=n.split(" ");if(a[0].endsWith("px")&&(i.xOffset=Math.round(parseFloat(a[0]))),a[1].endsWith("px")&&(i.yOffset=Math.round(parseFloat(a[1]))),"no-repeat"===o)switch(r){case"contain":case"cover":i.Mode=r;break;case"100% 100%":i.Mode="fill"}else i.Mode="tile";return i},set:function(t){if(Mt("background texture",t),null!=t&&(Wn("background image url",t.ImageURL),Cn("background image mode",t.Mode,e.WAT_BackgroundModes),e.expectLocation("background image x offset",t.xOffset),e.expectLocation("background image y offset",t.yOffset)),null==t)mn(this,{"background-image":void 0,"background-position":void 0,"background-size":void 0,"background-repeat":void 0});else{var n=void 0;switch(t.Mode){case"contain":case"cover":n=t.Mode;break;case"fill":n="100% 100%";break;case"tile":n="auto auto"}mn(this,{"background-image":'url("'+t.ImageURL+'")',"background-position":Math.round(t.xOffset)+"px "+Math.round(t.yOffset)+"px","background-size":n,"background-repeat":"tile"===t.Mode?"repeat":"no-repeat"})}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"BorderWidths",{get:function(){var e=this.Peer;return[parseFloat(se(e,"border-top-width")),parseFloat(se(e,"border-right-width")),parseFloat(se(e,"border-bottom-width")),parseFloat(se(e,"border-left-width"))]},set:function(t){_t("list of border widths",t),null!=t&&(e.expectDimension("top border width",t[0]),e.expectDimension("right border width",t[1]),e.expectDimension("bottom border width",t[2]),e.expectDimension("left border width",t[3])),mn(this,null==t?{"border-top-width":void 0,"border-right-width":void 0,"border-bottom-width":void 0,"border-left-width":void 0}:{"border-top-width":Math.round(t[0])+"px","border-right-width":Math.round(t[1])+"px","border-bottom-width":Math.round(t[2])+"px","border-left-width":Math.round(t[3])+"px"})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"BorderColors",{get:function(){var e=this.Peer;return[qn(se(e,"border-top-color")),qn(se(e,"border-right-color")),qn(se(e,"border-bottom-color")),qn(se(e,"border-left-color"))]},set:function(e){_t("list of border colors",e),null!=e&&(Sn("top border color",e[0]),Sn("right border color",e[1]),Sn("bottom border color",e[2]),Sn("left border color",e[3])),mn(this,null==e?{"border-top-color":void 0,"border-right-color":void 0,"border-bottom-color":void 0,"border-left-color":void 0}:{"border-top-color":e[0],"border-right-color":e[1],"border-bottom-color":e[2],"border-left-color":e[3]})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"BorderStyles",{get:function(){function t(t){return H(t,e.WAT_BorderStyles)?t:"none"}var n=this.Peer;return[t(se(n,"border-top-style")),t(se(n,"border-right-style")),t(se(n,"border-bottom-style")),t(se(n,"border-left-style"))]},set:function(t){_t("list of border styles",t),null!=t&&(Cn("top border style",t[0],e.WAT_BorderStyles),Cn("right border style",t[1],e.WAT_BorderStyles),Cn("bottom border style",t[2],e.WAT_BorderStyles),Cn("left border style",t[3],e.WAT_BorderStyles)),mn(this,null==t?{"border-top-style":void 0,"border-right-style":void 0,"border-bottom-style":void 0,"border-left-style":void 0}:{"border-top-style":t[0],"border-right-style":t[1],"border-bottom-style":t[2],"border-left-style":t[3]})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"BorderRadii",{get:function(){var e=this.Peer;return[parseFloat(se(e,"border-top-left-radius")),parseFloat(se(e,"border-top-right-radius")),parseFloat(se(e,"border-bottom-right-radius")),parseFloat(se(e,"border-bottom-left-radius"))]},set:function(t){_t("list of border radii",t),null!=t&&(e.expectDimension("top-left border radius",t[0]),e.expectDimension("top-right border radius",t[1]),e.expectDimension("bottom-right border radius",t[2]),e.expectDimension("bottom-left border radius",t[3])),null==t?vn(this,"border-radius",null):mn(this,{"border-top-left-radius":Math.round(t[0])+"px","border-top-right-radius":Math.round(t[1])+"px","border-bottom-right-radius":Math.round(t[2])+"px","border-bottom-left-radius":Math.round(t[3])+"px"})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"BoxShadow",{get:function(){var e=se(this.Peer,"box-shadow");if("none"===e)return{isInset:!1,xOffset:0,yOffset:0,BlurRadius:0,SpreadRadius:0,Color:"#00000000"};var t="inset"===(e=e.replace(/,.*$/,"").split(" "))[0];return t&&e.shift(),{isInset:t,xOffset:parseFloat(e[0]),yOffset:parseFloat(e[1]),BlurRadius:parseFloat(e[2]),SpreadRadius:parseFloat(e[3]),Color:qn(e[4])}},set:function(t){Mt("box shadow",t),null!=t&&(ie("box shadow direction",t.isInset),e.expectLocation("box shadow x offset",t.xOffset),e.expectLocation("box shadow y offset",t.yOffset),e.expectDimension("box shadow blur radius",t.BlurRadius),e.expectDimension("box shadow spread radius",t.SpreadRadius),Sn("box shadow color",t.Color)),null==t?vn(this,"box-shadow",null):"#00000000"===qn(t.Color)?vn(this,"box-shadow","none"):vn(this,"box-shadow",(t.isInset?"inset ":"")+Math.round(t.xOffset)+"px "+Math.round(t.yOffset)+"px "+Math.round(t.BlurRadius)+"px "+Math.round(t.SpreadRadius)+"px "+$n(qn(t.Color)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cursor",{get:function(){var e=se(this.Peer,"cursor");return e.indexOf(",")>0?e.replace(/^.*,\s*/,""):e},set:function(t){if(xn("cursor",t,e.WAT_Cursors),null==t)vn(this,"cursor",null);else{var n=se(this.Peer,"cursor");vn(this,"cursor",(n.indexOf(",")>0?n.replace(/,[^,]+$/,", "):"")+t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"customCursor",{get:function(){var e=/^url\(([^\)])\)(\s+\d+)?(\s+\d+)?,/.exec(se(this.Peer,"cursor"));if(null!=e){var t=e[1],n=parseFloat(e[2]),r=parseFloat(e[3]);return"'\"".indexOf(t[0])>=0&&(t=t.slice(1,t.length-1)),g(n,0,31)||(n=0),g(r,0,31)||(r=0),{ImageURL:t,xOffset:n,yOffset:r}}},set:function(e){Mt("custom cursor",e),null!=e&&(Wn("custom cursor image url",e.ImageURL),we("custom cursor x offset",e.xOffset,0,31),we("custom cursor y offset",e.yOffset,0,31));var t=se(this.Peer,"cursor"),n=t.indexOf(",")>0?t.replace(/^.*,\s*/,""):t;vn(this,"cursor",null==e?n:'url("'+e.ImageURL+'") '+Math.round(e.xOffset)+"px "+Math.round(e.yOffset)+"px, "+n)},enumerable:!1,configurable:!0}),t.prototype.trigger=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Qt.apply(void 0,o([this],e))},t}();e.WAT_Visual=yn;var wn=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t(r,n),Object.defineProperty(r.prototype,"Name",{get:function(){var e=fe(ln(this),"wat-name");return L(e)?e:void 0},set:function(e){q("Name")},enumerable:!1,configurable:!0}),r.prototype.globalVisual=function(t){if(e.expectUniversalName("global visual name",t),"#"===t[0])return Ut(this,t);d("InvalidArgument: the given visual name is not a global one")},Object.defineProperty(r.prototype,"isBeingPreserved",{get:function(){return"isBeingPreserved"===an(this).BackupStatus},set:function(e){q("isBeingPreserved")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isBeingRestored",{get:function(){return"isBeingRestored"===an(this).BackupStatus},set:function(e){q("isBeingRestored")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isBeingRemoved",{get:function(){return"isBeingRemoved"===an(this).BackupStatus},set:function(e){q("isBeingRemoved")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"CardList",{get:function(){var e=[];return te(ln(this).children,".WAT.Card").forEach((function(t){e.push(nn(t))})),e},set:function(e){q("CardList")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"CardLabelList",{get:function(){var e=[];return te(ln(this).children,".WAT.Card").forEach((function(t){e.push(nn(t).Label)})),e},set:function(e){q("CardLabelList")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"CardCount",{get:function(){return te(ln(this).children,".WAT.Card").length},set:function(e){q("CardCount")},enumerable:!1,configurable:!0}),r.prototype.Card=function(e){switch(!0){case h(e):return e.Applet===this?e:void 0;case y(e):return this.CardAtIndex(e);case k(e):return this.CardNamed(e);default:d("InvalidArgument: card, card name or card index expected")}},r.prototype.CardAtIndex=function(e){return ke("card index",e),this.CardList[e]},r.prototype.CardNamed=function(t){e.expectName("card name",t);var n=void 0;return te(this.Peer.children,".WAT.Card").forEach((function(e){var r=rn(e);r.Name===t&&(n=r)})),n},r.prototype.CardLabelled=function(t){e.expectLabel("card label",t);var n=void 0;return te(this.Peer.children,".WAT.Card").forEach((function(e){var r=rn(e);r.Label===t&&(n=r)})),n},r.prototype.IndexOfCard=function(e){var t=this.Card(e);return null==t?-1:this.CardList.indexOf(t)},r.prototype.acceptsCardAt=function(e,t){var n=this.IndexOfCard(e);return n>=0?this.CardMayBeShiftedTo(n,t):!((n=null==t?this.CardCount:this.IndexOfCard(t))<0)},r.prototype.acceptsNewCardAt=function(e,t){return"Card"===kt(e).Category&&!((null==t?this.CardCount:this.IndexOfCard(t))<0)},r.prototype.newCardInsertedAt=function(e,t){var n=kt(e);"Card"!==n.Category&&d("InvalidMaster: the given master cannot be used for a (new) card");var r=null==t?this.CardCount:this.IndexOfCard(t);return r<0&&d("InvalidArgument: the given insertion point does not exist or is not part of this applet"),this.CardDeserializedFrom(n.Template,r)},r.prototype.DuplicateOfCard=function(e){var t=this.IndexOfCard(e);t<0&&d("InvalidArgument: the given card does not exist or is not part of this applet");var n=qe(this.CardList[t]);return this.CardDeserializedFrom(n,t+1)},r.prototype.CardDeserializedFrom=function(e,t){Ye("card serialization",e);var n=null==t?this.CardCount:this.IndexOfCard(t);n<0&&d("InvalidArgument: the given insertion point does not exist or is not part of this applet");var r,o=me(e),i=this.CardAtIndex(n);null==i?this.Peer.append(o):this.Peer.insertBefore(o,i.Peer);try{r=cn(o,"Card")}catch(e){throw ve(o),e}return this.acceptsCardAt(r,n)||(ve(o),d("InvalidOperation: the given serialized card must not be inserted into this applet")),r},r.prototype.CardMayBeShiftedUp=function(e){return this.IndexOfCard(e)>0},r.prototype.CardMayBeShiftedDown=function(e){var t=this.IndexOfCard(e);return t>=0&&t<this.CardCount-1},r.prototype.CardMayBeShiftedTo=function(e,t){var n=this.IndexOfCard(e),r=this.IndexOfCard(t);return n>=0&&r>=0&&n!==r},r.prototype.shiftCardUp=function(e){var t,n=this.IndexOfCard(e);if(n<0&&d("InvalidArgument: the given card does not exist or is not part of this applet"),n>0){var r=this.CardAtIndex(n-1);null===(t=this.CardAtIndex(n))||void 0===t||t.Peer.insertBefore(r.Peer)}},r.prototype.shiftCardDown=function(e){var t,n=this.IndexOfCard(e);if(n<0&&d("InvalidArgument: the given card does not exist or is not part of this applet"),n<this.CardCount-1){var r=this.CardAtIndex(n+1);null===(t=this.CardAtIndex(n))||void 0===t||t.Peer.insertAfter(r.Peer)}},r.prototype.shiftCardTo=function(e,t){var n=this.IndexOfCard(e);n<0&&d("InvalidArgument: the given card does not exist or is not part of this applet");var r=this.IndexOfCard(t);if(r<0&&d("InvalidArgument: the given insertion point does not exist or is not part of this applet"),n!==r){var o=this.CardAtIndex(n);if(0===n)this.Peer.prepend(o.Peer);else{n<r&&(r+=1);var i=this.CardAtIndex(r);null==i?this.Peer.append(o.Peer):o.Peer.insertAfter(i.Peer)}}},r.prototype.removeCard=function(e){var t=this.Card(e);null!=t&&(bn(t,"recursively"),ve(t.Peer),0===this.CardCount&&se(this.newCardInsertedAt("plainCard",0).Peer,"visibility","visible"))},Object.defineProperty(r.prototype,"shownCard",{get:function(){for(var e=this.CardList,t=0,n=e.length;t<n;t++)if(e[t].isVisible)return e[t];return 0===e.length&&(e=[this.newCardInsertedAt("plainCard",0)]),this.showCard(e[0]),e[0]},set:function(e){q("shownCard")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"shownCardIndex",{get:function(){for(var e=this.CardList,t=0,n=e.length;t<n;t++)if(e[t].isVisible)return t;return 0===e.length&&(e=[this.newCardInsertedAt("plainCard",0)]),this.showCard(e[0]),0},set:function(e){q("shownCardIndex")},enumerable:!1,configurable:!0}),r.prototype.CardIsShown=function(e){var t=this.IndexOfCard(e);return t>=0&&this.CardAtIndex(t).isVisible},r.prototype.showCard=function(e){var t=this.IndexOfCard(e);if(t<0)d("InvalidArgument: the given card does not exist or is not part of this applet");else{var n=ln(this.CardAtIndex(t));te(this.Peer.children,".WAT.Card").forEach((function(e){se(e,"visibility",e===n?"visible":"hidden")}))}},r.prototype.showFirstCard=function(){this.showCard(0)},r.prototype.showPrevCard=function(){this.showCard(Math.max(0,this.shownCardIndex-1))},r.prototype.showPreviousCard=function(){this.showCard(Math.max(0,this.shownCardIndex-1))},r.prototype.showNextCard=function(){this.showCard(Math.min(this.shownCardIndex+1,this.CardCount-1))},r.prototype.showLastCard=function(){this.showCard(this.CardCount-1)},Object.defineProperty(r.prototype,"OverlayList",{get:function(){var e=[];return te(ln(this).children,".WAT.Overlay").forEach((function(t){e.push(nn(t))})),e},set:function(e){q("OverlayList")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"OverlayLabelList",{get:function(){var e=[];return te(ln(this).children,".WAT.Overlay").forEach((function(t){e.push(nn(t).Label)})),e},set:function(e){q("OverlayLabelList")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"OverlayCount",{get:function(){return te(ln(this).children,".WAT.Overlay").length},set:function(e){q("OverlayCount")},enumerable:!1,configurable:!0}),r.prototype.Overlay=function(e){switch(!0){case m(e):return e.Applet===this?e:void 0;case y(e):return this.OverlayAtIndex(e);case k(e):return this.OverlayNamed(e);default:d("InvalidArgument: overlay, overlay name or overlay index expected")}},r.prototype.OverlayAtIndex=function(e){return ke("card index",e),this.OverlayList[e]},r.prototype.OverlayNamed=function(t){e.expectName("overlay name",t);var n=void 0;return te(this.Peer.children,".WAT.Overlay").forEach((function(e){var r=rn(e);r.Name===t&&(n=r)})),n},r.prototype.OverlayLabelled=function(t){e.expectLabel("overlay label",t);var n=void 0;return te(this.Peer.children,".WAT.Overlay").forEach((function(e){var r=rn(e);r.Label===t&&(n=r)})),n},r.prototype.IndexOfOverlay=function(e){var t=this.Overlay(e);return null==t?-1:this.OverlayList.indexOf(t)},r.prototype.acceptsOverlayAt=function(e,t){var n=this.IndexOfOverlay(e);return n>=0?this.OverlayMayBeShiftedTo(n,t):!((n=null==t?this.OverlayCount:this.IndexOfOverlay(t))<0)},r.prototype.acceptsNewOverlayAt=function(e,t){return"Overlay"===kt(e).Category&&!((null==t?this.OverlayCount:this.IndexOfOverlay(t))<0)},r.prototype.newOverlayInsertedAt=function(e,t){var n=kt(e);"Overlay"!==n.Category&&d("InvalidMaster: the given master cannot be used for a (new) overlay");var r=null==t?this.OverlayCount:this.IndexOfOverlay(t);return r<0&&d("InvalidArgument: the given insertion point does not exist or is not part of this applet"),this.OverlayDeserializedFrom(n.Template,r)},r.prototype.DuplicateOfOverlay=function(e){var t=this.IndexOfOverlay(e);t<0&&d("InvalidArgument: the given overlay does not exist or is not part of this applet");var n=qe(this.OverlayList[t]);return this.OverlayDeserializedFrom(n,t+1)},r.prototype.OverlayDeserializedFrom=function(e,t){Ye("overlay serialization",e);var n=null==t?this.OverlayCount:this.IndexOfOverlay(t);n<0&&d("InvalidArgument: the given insertion point does not exist or is not part of this applet");var r,o=me(e),i=this.OverlayAtIndex(n);null==i?this.Peer.append(o):this.Peer.insertBefore(o,i.Peer);try{r=cn(o,"Overlay")}catch(e){throw ve(o),e}return this.acceptsOverlayAt(r,n)||(ve(o),d("InvalidOperation: the given serialized overlay must not be inserted into this applet")),r},r.prototype.OverlayMayBeShiftedUp=function(e){return this.IndexOfOverlay(e)>0},r.prototype.OverlayMayBeShiftedDown=function(e){var t=this.IndexOfOverlay(e);return t>=0&&t<this.OverlayCount-1},r.prototype.OverlayMayBeShiftedTo=function(e,t){var n=this.IndexOfOverlay(e),r=this.IndexOfOverlay(t);return n>=0&&r>=0&&n!==r},r.prototype.shiftOverlayUp=function(e){var t,n=this.IndexOfOverlay(e);if(n<0&&d("InvalidArgument: the given overlay does not exist or is not part of this applet"),n>0){var r=this.OverlayAtIndex(n-1);null===(t=this.OverlayAtIndex(n))||void 0===t||t.Peer.insertBefore(r.Peer)}},r.prototype.shiftOverlayDown=function(e){var t,n=this.IndexOfOverlay(e);if(n<0&&d("InvalidArgument: the given overlay does not exist or is not part of this applet"),n<this.OverlayCount-1){var r=this.OverlayAtIndex(n+1);null===(t=this.OverlayAtIndex(n))||void 0===t||t.Peer.insertAfter(r.Peer)}},r.prototype.shiftOverlayTo=function(e,t){var n=this.IndexOfOverlay(e);n<0&&d("InvalidArgument: the given overlay does not exist or is not part of this applet");var r=this.IndexOfOverlay(t);if(r<0&&d("InvalidArgument: the given insertion point does not exist or is not part of this applet"),n!==r){var o=this.OverlayAtIndex(n);if(0===n)this.Peer.prepend(o.Peer);else{n<r&&(r+=1);var i=this.OverlayAtIndex(r);null==i?this.Peer.append(o.Peer):o.Peer.insertAfter(i.Peer)}}},r.prototype.removeOverlay=function(e){var t=this.Overlay(e);null!=t&&(bn(t,"recursively"),ve(t.Peer))},r.prototype.frontmostOverlayOfClass=function(t){e.expectName("HTML class name",t);var n=te(this.Peer.children,".WAT.Overlay."+t),r=n[n.length-1];return null==r?void 0:nn(r)},r.prototype.bringOverlayToFrontOfClass=function(t,n){var r=this;e.expectName("HTML class name",n);var o=this.Overlay(t);null==o&&d("InvalidArgument: the given overlay does not exist or is not part of this applet");var i=o.Peer;i.classList.contains(n)||d("InvalidArgument: the given overlay does not have class "+Vn(n)+" itself");var a=!1;te(this.Peer.children,".WAT.Overlay."+n).forEach((function(e){switch(!0){case i===e:a=!0;break;case a:r.Peer.insertBefore(e,i)}}))},r}(yn);e.WAT_Applet=wn;var An=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t(r,n),Object.defineProperty(r.prototype,"ComponentList",{get:function(){var e=[];return te(ln(this).children,".WAT.Control,.WAT.Compound").forEach((function(t){e.push(nn(t))})),e},set:function(e){q("ComponentList")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"ComponentLabelList",{get:function(){var e=[];return te(ln(this).children,".WAT.Control,.WAT.Compound").forEach((function(t){e.push(nn(t).Label)})),e},set:function(e){q("ComponentLabelList")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"ComponentCount",{get:function(){return te(ln(this).children,".WAT.Control,.WAT.Compound").length},set:function(e){q("ComponentCount")},enumerable:!1,configurable:!0}),r.prototype.Component=function(e){switch(!0){case b(e):case x(e):return e.Container===this?e:void 0;case y(e):return this.ComponentAtIndex(e);case k(e):return this.ComponentNamed(e);default:d("InvalidArgument: component, component name or component index expected")}},r.prototype.ComponentAtIndex=function(e){return ke("component index",e),this.ComponentList[e]},r.prototype.ComponentNamed=function(t){e.expectName("component name",t);var n=void 0;return te(this.Peer.children,".WAT.Control,.WAT.Compound").forEach((function(e){var r=rn(e);r.Name===t&&(n=r)})),n},r.prototype.ComponentLabelled=function(t){e.expectLabel("component label",t);var n=void 0;return te(this.Peer.children,".WAT.Control,.WAT.Compound").forEach((function(e){var r=rn(e);r.Label===t&&(n=r)})),n},r.prototype.IndexOfComponent=function(e){var t=this.Component(e);return null==t?-1:this.ComponentList.indexOf(t)},r.prototype.acceptsComponentAt=function(e,t){var n=this.IndexOfComponent(e);return n>=0?this.ComponentMayBeShiftedTo(n,t):!((n=null==t?this.ComponentCount:this.IndexOfComponent(t))<0)},r.prototype.acceptsNewComponentAt=function(e,t){var n=kt(e);return("Control"===n.Category||"Compound"===n.Category)&&!((null==t?this.ComponentCount:this.IndexOfComponent(t))<0)},r.prototype.newComponentInsertedAt=function(e,t){var n=kt(e);"Control"!==n.Category&&"Compound"!==n.Category&&d("InvalidMaster: the given master cannot be used for a (new) component");var r=null==t?this.ComponentCount:this.IndexOfComponent(t);return r<0&&d("InvalidArgument: the given insertion point does not exist or is not part of this applet"),this.ComponentDeserializedFrom(n.Template,r)},r.prototype.DuplicateOfComponent=function(e){var t=this.IndexOfComponent(e);t<0&&d("InvalidArgument: the given component does not exist or is not part of this applet");var n=qe(this.ComponentList[t]);return this.ComponentDeserializedFrom(n,t+1)},r.prototype.ComponentDeserializedFrom=function(e,t){Ye("component serialization",e);var n=null==t?this.ComponentCount:this.IndexOfComponent(t);n<0&&d("InvalidArgument: the given insertion point does not exist or is not part of this container");var r,o=me(e),i=this.ComponentAtIndex(n);null==i?this.Peer.append(o):this.Peer.insertBefore(o,i.Peer);try{r=cn(o,"Component")}catch(e){throw ve(o),e}return this.acceptsComponentAt(r,n)||(ve(o),d("InvalidOperation: the given serialized component must not be inserted into this container")),r},r.prototype.ComponentMayBeShiftedUp=function(e){return this.IndexOfComponent(e)>0},r.prototype.ComponentMayBeShiftedDown=function(e){var t=this.IndexOfComponent(e);return t>=0&&t<this.ComponentCount-1},r.prototype.ComponentMayBeShiftedTo=function(e,t){var n=this.IndexOfComponent(e),r=this.IndexOfComponent(t);return n>=0&&r>=0&&n!==r},r.prototype.shiftComponentToTop=function(e){var t=this.IndexOfComponent(e);if(t<0&&d("InvalidArgument: the given component does not exist or is not part of this applet"),t>0){var n=this.ComponentAtIndex(t);this.Peer.prepend(n.Peer)}},r.prototype.shiftComponentUp=function(e){var t,n=this.IndexOfComponent(e);if(n<0&&d("InvalidArgument: the given component does not exist or is not part of this applet"),n>0){var r=this.ComponentAtIndex(n-1);null===(t=this.ComponentAtIndex(n))||void 0===t||t.Peer.insertBefore(r.Peer)}},r.prototype.shiftComponentDown=function(e){var t,n=this.IndexOfComponent(e);if(n<0&&d("InvalidArgument: the given component does not exist or is not part of this applet"),n<this.ComponentCount-1){var r=this.ComponentAtIndex(n+1);null===(t=this.ComponentAtIndex(n))||void 0===t||t.Peer.insertAfter(r.Peer)}},r.prototype.shiftComponentToBottom=function(e){var t=this.IndexOfComponent(e);if(t<0&&d("InvalidArgument: the given component does not exist or is not part of this applet"),t<this.ComponentCount-1){var n=this.ComponentAtIndex(t);this.Peer.append(n.Peer)}},r.prototype.shiftComponentTo=function(e,t){var n=this.IndexOfComponent(e);n<0&&d("InvalidArgument: the given component does not exist or is not part of this applet");var r=this.IndexOfComponent(t);if(r<0&&d("InvalidArgument: the given insertion point does not exist or is not part of this applet"),n!==r){var o=this.ComponentAtIndex(n);if(0===n)this.Peer.prepend(o.Peer);else{n<r&&(r+=1);var i=this.ComponentAtIndex(r);null==i?this.Peer.append(o.Peer):this.Peer.insertAfter(o.Peer,i.Peer)}}},r.prototype.ComponentMayBeRemoved=function(e){return this.IndexOfComponent(e)>=0},r.prototype.removeComponent=function(e){var t=this.Component(e);null!=t&&(bn(t,"recursively"),ve(t.Peer))},r}(yn);e.WAT_Container=An;var Pn=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n}(An);e.WAT_Layer=Pn;var Tn=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),Object.defineProperty(n.prototype,"isVisible",{get:function(){return"hidden"!==se(this.Peer,"visibility")},set:function(e){ie("visibility",e),!0===e?this.Applet.showCard(this):d("InvalidArgument: a card cannot be explicitly hidden, please select another card to be shown instead")},enumerable:!1,configurable:!0}),n.prototype.show=function(){this.isVisible=!0},Object.defineProperty(n.prototype,"mayBeDisplaced",{get:function(){return!1},set:function(e){q("mayBeDisplaced")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mayBeDeformed",{get:function(){return!1},set:function(e){q("mayBeDeformed")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Index",{get:function(){return this.Applet.IndexOfCard(this)},set:function(e){q("Index")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mayBeShiftedUp",{get:function(){return this.Applet.CardMayBeShiftedUp(this)},set:function(e){q("mayBeShiftedUp")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mayBeShiftedDown",{get:function(){return this.Applet.CardMayBeShiftedDown(this)},set:function(e){q("mayBeShiftedDown")},enumerable:!1,configurable:!0}),n.prototype.mayBeShiftedTo=function(e){return this.Applet.CardMayBeShiftedTo(this,e)},n.prototype.shiftUp=function(){this.Applet.shiftCardUp(this)},n.prototype.shiftDown=function(){this.Applet.shiftCardDown(this)},n.prototype.shiftTo=function(e){this.Applet.shiftCardTo(this,e)},Object.defineProperty(n.prototype,"mayBeRemoved",{get:function(){return this.Applet.CardMayBeRemoved(this)},set:function(e){q("mayBeRemoved")},enumerable:!1,configurable:!0}),n.prototype.remove=function(){this.Applet.removeCard(this)},n}(Pn);e.WAT_Card=Tn;var Mn=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t(r,n),Object.defineProperty(r.prototype,"mayBeDisplaced",{get:function(){return!0},set:function(e){q("mayBeDisplaced")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"mayBeDeformed",{get:function(){return!0},set:function(e){q("mayBeDeformed")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"Index",{get:function(){return this.Applet.IndexOfOverlay(this)},set:function(e){q("Index")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"mayBeShiftedUp",{get:function(){return this.Applet.OverlayMayBeShiftedUp(this)},set:function(e){q("mayBeShiftedUp")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"mayBeShiftedDown",{get:function(){return this.Applet.OverlayMayBeShiftedDown(this)},set:function(e){q("mayBeShiftedDown")},enumerable:!1,configurable:!0}),r.prototype.mayBeShiftedTo=function(e){return this.Applet.OverlayMayBeShiftedTo(this,e)},r.prototype.shiftUp=function(){this.Applet.shiftOverlayUp(this)},r.prototype.shiftDown=function(){this.Applet.shiftOverlayDown(this)},r.prototype.shiftTo=function(e){this.Applet.shiftOverlayTo(this,e)},Object.defineProperty(r.prototype,"mayBeRemoved",{get:function(){return this.Applet.OverlayMayBeRemoved(this)},set:function(e){q("mayBeRemoved")},enumerable:!1,configurable:!0}),r.prototype.remove=function(){this.Applet.removeOverlay(this)},r.prototype.showAround=function(t,n,r){void 0===r&&(r="withinViewport"),e.expectLocation("x coordinate",t),e.expectLocation("y coordinate",n),Cn("positioning constraint",r,["withinApplet","withinViewport"]);var o=this.Applet;if("withinApplet"===r)ht(this,t=Math.max(0,Math.min(t,o.Width-this.Peer.offsetWidth)),n=Math.max(0,Math.min(n,o.Height-this.Peer.offsetHeight)),void 0,void 0);else{var i=document.body.clientWidth,a=Math.max(window.innerHeight,document.body.clientHeight);t=Math.max(0,Math.min(t,i-this.Peer.offsetWidth)),n=Math.max(0,Math.min(n,a-this.Peer.offsetHeight));var l=o.GeometryOnDisplay;ht(this,t-l.x,n-l.y,void 0,void 0)}},r.prototype.isFrontmostOfClass=function(e){return this.Applet.frontmostOverlayOfClass(e)===this},r.prototype.bringToFrontOfClass=function(e){this.Applet.bringOverlayToFrontOfClass(e)},r}(Pn);e.WAT_Overlay=Mn;var En=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),Object.defineProperty(n.prototype,"mayBeDisplaced",{get:function(){var e=this.Container;if(null==e)return!1;var t=gt[e.Master];if(null==t)return!1;var n=t.Styles||{};return!("left"in n||"width"in n&&"right"in n)||!("top"in n||"height"in n&&"bottom"in n)},set:function(e){q("mayBeDisplaced")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mayBeDeformed",{get:function(){var e=this.Container;if(null==e)return!1;var t=gt[e.Master];if(null==t)return!1;var n=t.Styles||{};return!("width"in n||"left"in n&&"right"in n)||!("height"in n||"top"in n&&"bottom"in n)},set:function(e){q("mayBeDeformed")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Index",{get:function(){return this.Container.IndexOfComponent(this)},set:function(e){q("Index")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mayBeShiftedUp",{get:function(){return this.Container.CompoundMayBeShiftedUp(this)},set:function(e){q("mayBeShiftedUp")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mayBeShiftedDown",{get:function(){return this.Container.CompoundMayBeShiftedDown(this)},set:function(e){q("mayBeShiftedDown")},enumerable:!1,configurable:!0}),n.prototype.mayBeShiftedTo=function(e){return this.Container.CompoundMayBeShiftedTo(this,e)},n.prototype.shiftUp=function(){this.Container.shiftCompoundUp(this)},n.prototype.shiftDown=function(){this.Container.shiftCompoundDown(this)},n.prototype.shiftTo=function(e){this.Container.shiftCompoundTo(this,e)},Object.defineProperty(n.prototype,"mayBeRemoved",{get:function(){return this.Container.ComponentMayBeRemoved(this)},set:function(e){q("mayBeRemoved")},enumerable:!1,configurable:!0}),n.prototype.remove=function(){this.Container.removeCompound(this)},n}(An);e.WAT_Compound=En;var jn,Nn=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),Object.defineProperty(n.prototype,"mayBeDisplaced",{get:function(){var e=this.Container;if(null==e)return!1;var t=gt[e.Master];if(null==t)return!1;var n=t.Styles||{};return!("left"in n||"width"in n&&"right"in n)||!("top"in n||"height"in n&&"bottom"in n)},set:function(e){q("mayBeDisplaced")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mayBeDeformed",{get:function(){var e=this.Container;if(null==e)return!1;var t=gt[e.Master];if(null==t)return!1;var n=t.Styles||{};return!("width"in n||"left"in n&&"right"in n)||!("height"in n||"top"in n&&"bottom"in n)},set:function(e){q("mayBeDeformed")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Index",{get:function(){return this.Container.IndexOfComponent(this)},set:function(e){q("Index")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mayBeShiftedUp",{get:function(){return this.Container.CompoundMayBeShiftedUp(this)},set:function(e){q("mayBeShiftedUp")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mayBeShiftedDown",{get:function(){return this.Container.CompoundMayBeShiftedDown(this)},set:function(e){q("mayBeShiftedDown")},enumerable:!1,configurable:!0}),n.prototype.mayBeShiftedTo=function(e){return this.Container.CompoundMayBeShiftedTo(this,e)},n.prototype.shiftUp=function(){this.Container.shiftCompoundUp(this)},n.prototype.shiftDown=function(){this.Container.shiftCompoundDown(this)},n.prototype.shiftTo=function(e){this.Container.shiftCompoundTo(this,e)},Object.defineProperty(n.prototype,"mayBeRemoved",{get:function(){return this.Container.ComponentMayBeRemoved(this)},set:function(e){q("mayBeRemoved")},enumerable:!1,configurable:!0}),n.prototype.remove=function(){this.Container.removeCompound(this)},n}(yn);function kn(){return te(document.body.querySelectorAll(".WAT.Applet"),(function(e){return null==ne(e,".WAT.Applet")}))}e.WAT_Control=Nn,gt.plainApplet={Name:"plainApplet",Version:Ae(Ie("1.0.0")),Category:"Applet",Template:'<div class="WAT Applet"></div>',undesignablePropertySet:Object.assign(Object.create(null),{Name:!0,mayBeDeleted:!0,Overflows:!0,x:!0,y:!0,Width:!0,Height:!0,Position:!0,Size:!0,Geometry:!0,horizontalAnchoring:!0,verticalAnchoring:!0,horizontalOffsets:!0,verticalOffsets:!0,minWidth:!0,maxWidth:!0,minHeight:!0,maxHeight:!0}),UsageCount:0},gt.plainCard={Name:"plainCard",Version:Ae(Ie("1.0.0")),Category:"Card",Template:'<div class="WAT Card"></div>',undesignablePropertySet:Object.assign(Object.create(null),{x:!0,y:!0,Width:!0,Height:!0,Position:!0,Size:!0,Geometry:!0,horizontalAnchoring:!0,verticalAnchoring:!0,horizontalOffsets:!0,verticalOffsets:!0,minWidth:!0,maxWidth:!0,minHeight:!0,maxHeight:!0}),UsageCount:0},gt.plainOverlay={Name:"plainOverlay",Version:Ae(Ie("1.0.0")),Category:"Overlay",Template:'<div class="WAT Overlay"></div>',UsageCount:0},gt.plainControl={Name:"plainControl",Version:Ae(Ie("1.0.0")),Category:"Control",Template:'<div class="WAT Control"></div>',UsageCount:0},gt.plainCompound={Name:"plainCompound",Version:Ae(Ie("1.0.0")),Category:"Compound",Template:'<div class="WAT Compound"></div>',UsageCount:0},e.AppletPeersInDocument=kn,e.registerDesigner=function(e){jt("WAT designer",e),M(e.startDesigning)&&M(e.layoutsApplet)||d("InvalidArgument: the given object is no valid WAT Designer"),null==jn?jn=e:jn!==e&&d("DesignerExists: another WAT Designer has already been registered")};var Ln=!1,Bn=[];e.ready=function(e){if(lt("function to call",e),Ln&&!_n)return e();Bn.push(e)};var _n=!1;var Fn=!1,Dn=[];e.running=function(e){if(lt("function to call",e),Fn&&!Un)return e();Dn.push(e)};var Un=!1;function Hn(){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return Ln=!0,function(){console.log("WAT is ready"),_n=!0;for(var e=0;e<Bn.length;e++)try{Bn[e]()}catch(e){console.error('registered WAT "ready" handler failed with ',e)}_n=!1}(),[4,Jn()];case 1:return e.sent(),Fn=!0,function(){console.log("WAT is running"),Un=!0;for(var e=0;e<Dn.length;e++)try{Dn[e]()}catch(e){console.error('registered WAT "running" handler failed with ',e)}Un=!1}(),[2]}}))}))}function Jn(){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,kn().forEach((function(e){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,Zn(e)];case 1:return t.sent(),[2]}}))}))}))];case 1:return e.sent(),[2]}}))}))}function Zn(e){return n(this,void 0,void 0,(function(){var t,n;return r(this,(function(r){switch(r.label){case 0:return(n=Ve)?[4,Re(e)]:[3,2];case 1:n=r.sent(),r.label=2;case 2:return n?[4,ze(e)]:[3,4];case 3:return t=r.sent(),[3,5];case 4:t=cn(e,"Applet"),r.label=5;case 5:return t.trigger("applet-started",t),[2]}}))}))}function Kn(){var e;!function(){function e(e){for(var t in e)e.hasOwnProperty(t)&&(xt[t]=t)}e(yn.prototype),e(wn.prototype),e(An.prototype),e(Pn.prototype),e(Tn.prototype),e(Mn.prototype),e(En.prototype),e(Nn.prototype),delete xt.Value}(),e=!1,ee(document.head.querySelectorAll('script[type="application/wat-master"]'),(function(t){try{var n=bt(t);Ot(n,{compatibleDowngrade:"ignore",incompatibleDowngrade:"abort",sameVersion:"ignore",compatibleUpgrade:"perform",incompatibleUpgrade:"perform"})&&St(n)}catch(t){e=!0,console.warn("Error in Master Registration:",t)}})),e&&window.alert("The WAT masters bundled with this document could not be\nregistered without errors - see browser console for details"),he(document,"click",".WAT-ErrorIndicator"),pe(document,"click",".WAT-ErrorIndicator",(function(e){var t=e.target,n=nn(null==t?void 0:t.closest(".WAT"));if(null!=n){var r=Xt(n);null!=r&&(null!=jn&&n.Applet.mayBeDesigned?window.confirm(r.Title+"\n\n"+r.longMessage+(null!=r.Reason?"\n\nReason:\n"+r.Reason:"")+"\n\nDo you want to proceed to the Designer?")&&jn.startDesigning(r.Sufferer,r.Property):window.alert(r.Title+"\n\n"+r.longMessage+(null!=r.Reason?"\n\nReason:\n"+r.Reason:"")))}else alert("WAT Error\n\nCould not find Visual for this Error Indicator")})),Ve?s.ready((function(){_e=s.createInstance({name:"WAT Applets"}),Hn()})):Hn()}u.WAT=Object.assign(e.ready,e),"complete"===document.readyState||"interactive"===document.readyState?setTimeout(Kn,1):window.addEventListener("DOMContentLoaded",Kn),u.WAT=e}(Jn||(Jn={}))}();
//# sourceMappingURL=webapp-tinkerer-runtime.min.js.map
